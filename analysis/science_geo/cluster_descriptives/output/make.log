--------------------------------------------------------------------------------
Makelog started: 2024-09-29 00:37:36
Working directory: /export/projects4/achandra_basicscience/analysis/science_geo/cluster_descriptives/code
--------------------------------------------------------------------------------
External links successfully created!

  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      18.0
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-STATA-PC        https://www.stata.com
                                   979-696-4600        stata@stata.com

Stata license: Unlimited-user 4-core network, expiring 17 Nov 2024
Serial number: 501809301897
  Licensed to: Harvard Business School
               Research Computing

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 120,000; see help set_maxvar.

. do "/export/projects4/achandra_basicscience/analysis/science_geo/cluster_desc
> riptives/code/analysis.do" 

. set more off 

. clear all

. capture log close

. program drop _all

. set scheme modern

. graph set window fontface "Arial Narrow"
not available in non-GUI version

. pause on

. set seed 8975

. global cite_affl_wt_name "Productivity"

. global impact_cite_affl_wt_name "Productivity"

. global body_adj_wt_name "Paper-to-Patent Citations"

. global ln_y_name "Log Productivity"

. global ln_pat_name "Log Paper-to-Patent Citations"

. global msa_size_name "Cluster Size"

. global ln_x_name "Log Cluster Size"

. global time year

. 
. program main
  1.     foreach s in year_firstlast year year_firstlast_cns {
  2.         sample_desc, samp(`s')
  3.         maps, samp(`s')
  4.         raw_bs, samp(`s')
  5.         *econ_regression, samp(`s')
.         regression, samp(`s')
  6.         *firm_externalities, samp(`s')
.         output_tables, samp(`s')
  7.     }
  8. end

. 
. program sample_desc
  1.     syntax, samp(str) 
  2.     use ../external/econs_samp/athr_panel_full_comb_year.dta, clear
  3.     gcollapse (mean) msa_size, by(msa_comb)
  4.     rename msa_size econ_msa_size
  5.     save ../temp/econs_cluster, replace
  6.     use if !mi(msa_comb) & inrange(year, 1945,2022) using ../external/samp
> /athr_panel_full_comb_`samp', clear 
  7.     count
  8.     gunique athr_id
  9.     gen ln_y = ln(impact_cite_affl_wt)
 10.     gen ln_x = ln(msa_size)
 11.     gen ln_pat = ln(body_adj_wt)
 12.     foreach var in impact_cite_affl_wt msa_size ln_y ln_x body_adj_wt ln_p
> at {
 13.         qui sum `var', d
 14.         local N = r(N)
 15.         local mean : dis %3.2f r(mean)
 16.         local sd : dis %3.2f r(sd)
 17.         local p5 :  dis %3.2f r(p5)
 18.         local p25 :  dis %3.2f r(p25)
 19.         local p50 :  dis %3.2f r(p50)
 20.         local p75 :  dis %3.2f r(p75)
 21.         local p95 :  dis %3.2f r(p95)
 22.         tw hist `var', frac ytitle("Share of author-years", size(vsmall)) 
> xtitle("${`var'_name}", size(vsmall)) color(edkblue) xlab(, labsize(vsmall)) 
> ylab(, labsize(vsmall)) legend(on order(- "N = `N'" ///
>                                                                 "Mean = `mean
> '" ///
>                                                                 "            
> (`sd')" ///
>                                                                 "p5 = `p5'" /
> //
>                                                                 "p25 = `p25'"
>  ///
>                                                                 "p50 = `p50'"
>  ///
>                                                                 "p75 = `p75'"
>  ///
>                                                                 "p95 = `p95'"
> ) pos(1) ring(0) size(vsmall) region(fcolor(none)))
 23.         *graph export ../output/figures/`var'_dist`samp'.pdf, replace
.     }
 24.     preserve
 25.     keep if inrange(year, 2015,2022)
 26.     gcollapse (mean) msa_size cluster_shr, by(msa_comb)
 27.     gsort -msa_size
 28.     mkmat msa_size in 1/30, mat(top_30clus_`samp')
 29.     li in 1/30
 30.     mkmat msa_size in 1/10, mat(top_10clus_`samp')
 31.     restore
 32.     preserve
 33.     gen has_patent_cite = pat_wt > 0
 34.     bys athr_id msa_comb: gen athr_cnt = _n == 1
 35.     gcollapse  (sum) athr_cnt body_adj_wt cite_affl_wt pat_wt affl_wt impa
> ct_cite_affl_wt impact_affl_wt (mean) msa_size has_patent_cite, by(msa_comb)
 36.     merge 1:1 msa_comb using ../temp/econs_cluster, assert(1 2 3) keep(1 3
> ) nogen
 37. 
.     qui reg body_adj_wt impact_cite_affl_wt 
 38.     local coef : dis %3.2f _b[impact_cite_affl_wt]
 39.     local N = e(N)
 40.     binscatter2 body_adj_wt impact_cite_affl_wt , xtitle("Productivity", s
> ize(vsmall)) ytitle("Paper-to-Patent Citations", size(vsmall)) lcolor(ebblue)
>  mcolor(gs3) xlab(, labsize(vsmall)) ylab(, labsize(vsmall)) legend(on order(
> - "N (MSAs) = `N'" ///
>                                                                              
>                                          "Slope = `coef'") pos(5) ring(0) reg
> ion(fcolor(none)) size(vsmall))
 41.     *graph export ../output/figures/msa_pat_prod_`samp'.pdf, replace
.     gen ln_pat = ln(body_adj_wt)
 42.     gen ln_y = ln(impact_cite_affl_wt)
 43.     qui reg ln_pat ln_y 
 44.     local coef : dis %3.2f _b[ln_y]
 45.     local N = e(N)
 46.     binscatter2 ln_pat ln_y , xtitle("Log Productivity", size(vsmall)) yti
> tle("Log Paper-to-Patent Citations", size(vsmall)) lcolor(ebblue) mcolor(gs3)
>   xlab(, labsize(vsmall)) ylab(, labsize(vsmall)) legend(on order(- "N (MSAs)
>  = `N'" ///
>                                                                              
>                                          "Slope = `coef'") pos(5) ring(0) reg
> ion(fcolor(none)) size(vsmall))
 47.     *graph export ../output/figures/msa_log_pat_prod_`samp'.pdf, replace
.     
.     xtile p  = msa_size, nq(20)
 48.     gen msa_lab = "" 
 49.    replace msa_lab =  msa_comb if msa_comb == "San Diego-Carlsbad, CA" 
 50.    replace msa_lab =  msa_comb if msa_comb == "Bay Area, CA" 
 51.    replace msa_lab =  msa_comb if msa_comb == "St. Louis, MO-IL" 
 52.    replace msa_lab =  msa_comb if msa_comb == "Minneapolis-St. Paul-Bloomi
> ngton, MN-WI" 
 53.    replace msa_lab =  msa_comb if msa_comb == "Washington-Arlington-Alexan
> dria, DC-VA-MD-WV" 
 54.    replace msa_lab =  msa_comb if msa_comb == "Los Angeles-Long Beach-Anah
> eim, CA" 
 55.    replace msa_lab =  msa_comb if msa_comb == "Boston-Cambridge-Newton, MA
> -NH" 
 56.    replace msa_lab =  msa_comb if msa_comb == "New York-Newark-Jersey City
> , NY-NJ-PA" 
 57.     replace msa_lab =  msa_comb  if msa_comb == "New Haven-Milford , CT" 
 58.    egen clock = mlabvpos(msa_size econ_msa_size)
 59.    replace clock = 9 if inlist(msa_lab , "New York-Newark-Jersey City, NY-
> NJ-PA","Boston-Cambridge-Newton, MA-NH", "Washington-Arlington-Alexandria, DC
> -VA-MD-WV")
 60.    replace clock = 3 if inlist(msa_lab , "Minneapolis-St. Paul-Bloomington
> , MN-WI", "San Diego-Carlsbad, CA", "St. Louis, MO-IL", "Bay Area, CA")
 61.     tw scatter impact_cite_affl_wt msa_size , mcolor(gs7%50) msize(vsmall)
>  xlabel(#10, labsize(vsmall)) ylab(#10, labsize(vsmall)) || scatter impact_ci
> te_affl_wt msa_size if !mi(msa_lab) , mcolor(ebblue) msize(vsmall)  mlabel(ms
> a_lab) mlabcolor(black) mlabsize(tiny) xtitle("MSA Cluster Size", size(vsmall
> )) ytitle("MSA Productivity", size(vsmall))  jitter(5) legend(off)
 62.    *graph export ../output/figures/cluster_prod_scatter_`samp'.pdf, replac
> e
.     corr msa_size econ_msa_size 
 63.     local slope : dis %3.2f r(rho) 
 64.     reg msa_size econ_msa_size
 65.     local N = e(N)
 66.     tw scatter msa_size econ_msa_size, mcolor(gs7%50) msize(vsmall) xlabel
> (#10, labsize(vsmall)) ylab(#10, labsize(vsmall)) || ///
>        scatter msa_size econ_msa_size if !mi(msa_lab) , mcolor(ebblue) mlabvp
> (clock) msize(vsmall)  mlabel(msa_lab) mlabcolor(black) mlabsize(tiny) || ///
>        (function y = _b[econ_msa_size]*x + _b[_cons], range(0 900) lpattern(d
> ash) lcolor(lavender)), ytitle("Fundamental Science Cluster Size", size(vsmal
> l)) xtitle("Economics Research Cluster Size", size(vsmall))  legend(on order 
> (- "N (MSAs) = `N'" ///
>                                                                              
>                                                                              
>                     "Correlation = `slope'") pos(5) ring(0) region(fcolor(non
> e)) size(vsmall) lwidth(none))
 67.     graph export ../output/figures/econ_v_ls_`samp'.pdf, replace
 68.     drop clock
 69.    xtile p_prod = impact_cite_affl_wt, nq(20)
 70.    replace msa_lab = ""
 71.    replace msa_lab =  msa_comb if msa_comb == "San Diego-Carlsbad, CA" 
 72.    replace msa_lab =  msa_comb if msa_comb == "Bay Area, CA" 
 73.    replace msa_lab =  msa_comb if msa_comb == "St. Louis, MO-IL" 
 74.    replace msa_lab =  msa_comb if msa_comb == "Minneapolis-St. Paul-Bloomi
> ngton, MN-WI" 
 75.    replace msa_lab =  msa_comb if msa_comb == "Washington-Arlington-Alexan
> dria, DC-VA-MD-WV" 
 76.    replace msa_lab =  msa_comb if msa_comb == "Los Angeles-Long Beach-Anah
> eim, CA" 
 77.    replace msa_lab =  msa_comb if msa_comb == "Boston-Cambridge-Newton, MA
> -NH" 
 78.    replace msa_lab =  msa_comb if msa_comb == "New York-Newark-Jersey City
> , NY-NJ-PA" 
 79.    egen clock = mlabvpos(impact_cite_affl_wt body_adj_wt)
 80.    replace clock = 9 if inlist(msa_lab , "New York-Newark-Jersey City, NY-
> NJ-PA","Boston-Cambridge-Newton, MA-NH")
 81.    replace clock = 3 if inlist(msa_lab , "Minneapolis-St. Paul-Bloomington
> , MN-WI", "Washington-Arlington-Alexandria, DC-VA-MD-WV", "San Diego-Carlsbad
> , CA", "St. Louis, MO-IL", "Bay Area, CA")
 82.    qui reg body_adj_wt impact_cite_affl_wt 
 83.    local coef : dis %3.2f _b[impact_cite_affl_wt]
 84.    local cons : dis %3.2f _b[_cons]
 85.    local N = e(N)
 86.    tw scatter body_adj_wt impact_cite_affl_wt  , mcolor(gs13%50) msize(vsm
> all) xlabel(0(5000)60000, labsize(vsmall)) ylab(0(5000)60000, labsize(vsmall)
> ) || ///
>       scatter body_adj_wt impact_cite_affl_wt if !mi(msa_lab) , mlabvp(clock)
>  mcolor(ebblue) msize(vsmall)  mlabel(msa_lab) mlabcolor(black) mlabsize(tiny
> ) || ///
>       (function y=_b[impact_cite_affl_wt]*x+_b[_cons] , range(0 60000) lpatte
> rn(dash) lcolor(lavender)), xtitle("MSA Productivity", size(vsmall)) ytitle("
> MSA Paper-to-Patent Citations", size(vsmall)) legend(on order(- "N (MSAs) = `
> N'" ///
>                                                                              
>                                          "Slope = `coef'") pos(5) ring(0) reg
> ion(fcolor(none)) size(vsmall))
 87.    graph export ../output/figures/pat_prod_scatter_`samp'.pdf, replace
 88. end

. 
. program  maps
  1.     syntax, samp(str) 
  2.     spshape2dta ../external/geo/cb_2018_us_state_500k.shp, replace saving(
> usa_state)
  3.     use usa_state_shp, clear
  4.     merge m:1 _ID using usa_state
  5.     destring STATEFP, replace
  6.     drop if STATEFP > 56
  7.     // alaska
.     drop if _X > 0 & !mi(_X) & STATEFP == 2  
  8.     geo2xy _Y _X if STATEFP ==2, proj(mercator) replace
  9.     replace _Y = _Y / 5 +1200000 if STATEFP == 2 
 10.     replace _X = _X / 5 - 2000000  if STATEFP == 2 
 11.     drop if _X < -160 & !mi(_X) & _ID == 43  // small islands to the west
 12.     geo2xy _Y _X if _ID == 43, proj(mercator) replace
 13.     replace _Y = _Y  + 800000 if _ID == 43
 14.     replace _X = _X  - 1200000 if _ID == 43
 15.     geo2xy _Y _X if !inlist(_ID, 28,43), replace proj(mercator)
 16.     replace _X = _X + 53500 if !inlist(_ID, 28,43)
 17.     replace _Y = _Y - 3100 if !inlist(_ID, 28,43)
 18.     drop _CX- _merge
 19.     sort _ID shape_order
 20.     save usa_state_shp_clean.dta, replace
 21.     
.     spshape2dta ../external/geo/cb_2018_us_cbsa_500k.shp, replace saving(usa_
> msa)
 22.     use usa_msa_shp, clear
 23.     merge m:1 _ID using usa_msa, nogen
 24.     destring CBSAFP, replace
 25.     gen state = strtrim(substr(NAME, strpos(NAME, ",")+1, 3))
 26.     drop if inlist(state, "PR")
 27.     // alaska
.     drop if _X > 0 & !mi(_X) & state == "AK" 
 28.     geo2xy _Y _X if state == "AK" , proj(mercator) replace
 29.    replace _Y = _Y / 5 + 1200000 if state == "AK"
 30.     replace _X = _X / 5 - 1705000 if state == "AK" 
 31.     drop if _X < -160 & !mi(_X) & state == "HI"  // small islands to the w
> est
 32.     geo2xy _Y _X if state == "HI", proj(mercator) replace
 33.     replace _Y = _Y + 800000 if state == "HI" 
 34.     replace _X = _X  - 1200000 if state == "HI" 
 35.     geo2xy _Y _X if !inlist(state, "AK", "HI"), replace proj(mercator)
 36.     sort _ID shape_order
 37.     save usa_msa_shp_clean.dta, replace
 38. 
.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/samp/a
> thr_panel_full_`samp', clear
 39. *    bys msa_comb: egen mode = mode(msacode)
. *    replace msacode = mode
.     merge m:1 msacode using ../external/geo/msas, assert(1 2 3) keep(1 3) nog
> en
 40.     replace msa_comb = msatitle if !mi(msatitle)
 41.     replace msa_comb = "San Francisco-Oakland-Hayward, CA" if msa_comb == 
> "San Francisco-Oakland-Haywerd, CA"
 42.     replace msa_comb = "Macon-Bibb County, GA" if msa_comb == "Macon, GA"
 43.     bys athr_id msa_comb ${time} : gen count = _n == 1
 44.     gcollapse (sum) affl_wt impact_cite_affl_wt body_adj_wt (mean) msa_siz
> e , by(msa_comb)
 45.     save ../temp/map_samp, replace
 46.     
.     use usa_msa, clear
 47.     rename NAME msa_comb
 48.     merge 1:m msa_comb using ../temp/map_samp, assert(1 2 3) keep(1 3) nog
> en
 49.     foreach var in impact_cite_affl_wt {
 50.         xtile `var'_5 = `var', nq(5)
 51.         qui sum `var' 
 52.         local min : dis %3.2f r(min)
 53.         local max : dis %3.2f r(max)
 54.         _pctile `var',percentiles(20 40 60 80)
 55.         local p20: dis %3.2f r(r1)
 56.         local p40: dis %3.2f r(r2)
 57.         local p60: dis %3.2f r(r3)
 58.         local p80: dis %3.2f r(r4)
 59.         colorpalette carto Teal, n(5) nograph 
 60.         spmap  `var'_5 using usa_msa_shp_clean,  id(_ID)  fcolor(`r(p)'%50
> ) clnumber(5) ///
>           ocolor(white ..) osize(0.15 ..) ndfcolor(gs13) ndocolor(white ..) n
> dsize(0.15 ..) ndlabel("No data") ///
>           polygon(data("usa_state_shp_clean") ocolor(gs2) osize(0.2) fcolor(e
> ggshell%20)) ///
>           legend(label(2 "Min-p20: `min'-`p20'") label(3 "p20-p40: `p20'-`p40
> '") label(4 "p40-p60: `p40'-`p60'") label(5 "p60-p80: `p60'-`p80'") label(6 "
> p80-Max: `p80'-`max'") pos(4) size(2)) legtitle("${`var'_name}")
 61.         graph export ../output/figures/`var'_map_`samp'.pdf, replace
 62.     }
 63. end

. 
. program raw_bs
  1.     syntax, samp(str) 
  2.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/sam
> p/athr_panel_full_comb_`samp', clear
  3.     drop if mi(msa_comb) 
  4.     gegen msa = group(msa_comb)
  5.     gen ln_y = ln(impact_cite_affl_wt)
  6.     gen ln_x = ln(msa_size)
  7.     gen ln_pat = ln(body_adj_wt)
  8. 
.     // patented vs productivity
.     qui reg body_adj_wt impact_cite_affl_wt 
  9.     local coef : dis %3.2f _b[impact_cite_affl_wt]
 10.     local N = e(N)
 11.     binscatter2 body_adj_wt impact_cite_affl_wt, xtitle("Productivity", si
> ze(vsmall)) ytitle("Paper-to-Patent Citations", size(vsmall)) xlab(, labsize(
> vsmall)) ylab(, labsize(vsmall)) mcolor(gs5) lcolor(ebblue) legend(on order(-
>  "N (Author-years) = `N'" ///
>                                                                              
>                                          "Slope = `coef'") pos(5) ring(0) reg
> ion(fcolor(none)) size(vsmall))
 12.     *graph export ../output/figures/pat_prod_`samp'.pdf, replace
.     qui reg ln_pat ln_y 
 13.     local coef : dis %3.2f _b[ln_y]
 14.     local N = e(N)
 15.     binscatter2 ln_pat ln_y , xtitle("Log Productivity", size(vsmall)) yti
> tle("Log Paper-to-Patent Citations", size(vsmall)) xlab(, labsize(vsmall)) yl
> ab(, labsize(vsmall)) mcolor(gs5) lcolor(ebblue) legend(on order(- "N (Author
> -years) = `N'" ///
>                                                                              
>                                          "Slope = `coef'") pos(5) ring(0) reg
> ion(fcolor(none)) size(vsmall))
 16.     *graph export ../output/figures/log_pat_prod_`samp'.pdf, replace
. end

. 
. program econ_regression 
  1.     syntax, samp(str) 
  2.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/sam
> p/athr_panel_full_comb_`samp', clear 
  3.     gcollapse (mean) msa_size, by(msa_comb year)
  4.     rename msa_size ls_msa_size
  5.     save ../temp/ls_yr_cluster, replace
  6.     
.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/econs_
> samp/athr_panel_full_comb_year.dta, clear
  7.     merge m:1 msa_comb year using  ../temp/ls_yr_cluster, assert(1 2 3) ke
> ep(1 3) nogen
  8.     local reg_eq "ln_y ln_x"
  9.     local mat_est "_b[ln_x] \ _se[ln_x]"
 10.     bys athr_id msa_comb ${time} : gen count = _n == 1
 11.     replace msa_size = 0.0000000000001 if msa_size == 0
 12.     replace ls_msa_size = 0.0000000000001 if ls_msa_size == 0
 13.     gegen msa = group(msa_comb)
 14.     rename inst inst_name
 15.     gegen inst = group(inst_id)
 16.     gen ln_y = ln(cite_affl_wt)
 17.     gen ln_x = ln(ls_msa_size)
 18.     gen ln_x_econ = ln(msa_size)
 19.     reghdfe `reg_eq', noabsorb
 20.     local slope = _b[ln_x]
 21.     foreach fe in "${time} msa" "${time} msa inst" "${time} msa inst athr_
> id" {
 22.         reghdfe `reg_eq', absorb(`fe') vce(cluster msa)
 23.         mat econ_coef_`samp' = nullmat(econ_coef_`samp'), (`mat_est' \ . \
>  . \e(N))
 24.         local slope : dis %3.2f _b[ln_x]
 25.     }
 26.     reghdfe ln_y ln_x_econ, absorb(${time} msa inst athr_id) vce(cluster m
> sa)
 27.     mat econ_`samp' = nullmat(econ_`samp'), (. \ . \ _b[ln_x_econ] \ _se[l
> n_x_econ] \ e(N))
 28.     mat econ_coef_`samp' = nullmat(econ_coef_`samp') , econ_`samp'
 29.     mat drop econ_`samp'
 30. end

. 
. program regression 
  1.     syntax, samp(str) 
  2.     use ../external/econs_samp/athr_panel_full_comb_year.dta, clear
  3.     gcollapse (mean) msa_size, by(msa_comb year)
  4.     rename msa_size econ_msa_size
  5.     save ../temp/econ_yr_cluster, replace
  6. 
.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/samp/a
> thr_panel_full_comb_`samp', clear 
  7.     gcollapse (mean) msa_size, by(msa_comb year)
  8.     merge 1:1 msa_comb year using ../temp/econ_yr_cluster, keep(3) nogen
  9.     corr msa_size econ_msa_size 
 10.     local slope : dis %3.2f r(rho) 
 11.     reg msa_size econ_msa_size
 12.     local N = e(N)
 13.     gen msa_lab = "" 
 14.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> San Diego-Carlsbad, CA" & year == 1973
 15.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> San Diego-Carlsbad, CA" & year == 19
 16.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> Trenton, NJ" & year == 2019
 17.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> New Haven-Milford , CT" & year == 2012
 18.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> New York-Newark-Jersey City, NY-NJ-PA" & year == 1996
 19.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> Bay Area, CA" & year == 1997 
 20.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> Bay Area, CA" & year == 2015 
 21.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> Boston-Cambridge-Newton, MA-NH" & year == 1997 
 22.     replace msa_lab =  msa_comb + " " + string(${time})   if msa_comb == "
> Boston-Cambridge-Newton, MA-NH" & year == 2012 
 23.     tw scatter msa_size econ_msa_size, mcolor(gs7%50) msize(vsmall) xlabel
> (#10, labsize(vsmall)) ylab(#10, labsize(vsmall)) || ///
>        scatter msa_size econ_msa_size if !mi(msa_lab) , mcolor(ebblue) msize(
> vsmall)  mlabel(msa_lab) mlabcolor(black) mlabsize(tiny) || ///
>        (function y = _b[econ_msa_size]*x + _b[_cons], range(0 1250) lpattern(
> dash) lcolor(lavender)), ytitle("Fundamental Science Cluster Size", size(vsma
> ll)) xtitle("Economics Research Cluster Size", size(vsmall))  legend(on order
>  (- "N (MSAs) = `N'" ///
>                                                                              
>                                                                              
>                     "Correlation = `slope'") pos(5) ring(0) region(fcolor(non
> e)) size(vsmall) lwidth(none))
 24.     
.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/samp/a
> thr_panel_full_comb_`samp', clear 
 25.     merge m:1 msa_comb year using  ../temp/econ_yr_cluster, assert(1 2 3) 
> keep(1 3) nogen
 26. /*    corr msa_size econ_msa_size 
>     local slope : dis %3.2f r(rho) 
>     binscatter2 msa_size econ_msa_size, mcolor(gs5) lcolor(ebblue) xlab(, lab
> size(vsmall)) ylab(, labsize(vsmall)) ytitle("Fundamental Science Research Cl
> uster Size", size(vsmall)) xtitle("Economics Research Cluster Size", size(vsm
> all)) legend(on order(- "Correlation = `slope'") pos(5) ring(0) lwidth(none) 
> size(vsmall) region(fcolor(none)))
>     graph export ../output/figures/econ_v_ls.pdf, replace*/
.     local reg_eq "ln_y ln_x"
 27.     local mat_est "_b[ln_x] \ _se[ln_x]"
 28. *    local reg_eq = cond("`samp'"=="year","ln_y ln_x avg_team_size","ln_y 
> ln_x") 
. *    local mat_est  = cond("`samp'"=="year","_b[ln_x] \ _se[ln_x] \ _b[avg_te
> am_size] \ _se[ln_x]", "_b[ln_x] \ _se[ln_x]") 
.     bys athr_id msa_comb ${time} : gen count = _n == 1
 29.     replace msa_size = 0.0000000000001 if msa_size == 0
 30.     replace econ_msa_size = 0.0000000000001 if econ_msa_size == 0
 31.     gegen msa = group(msa_comb)
 32.     rename inst inst_name
 33.     gegen inst = group(inst_id)
 34.     gegen msa_field = group(msa field)
 35.     gegen year_field = group(year field)
 36.     gen ln_y = ln(impact_cite_affl_wt)
 37.     gen ln_x = ln(msa_size)
 38.     gen ln_x_econ = ln(econ_msa_size)
 39.     preserve
 40.     keep if inrange(year, 2015, 2022)
 41.     keep if inlist(msa_comb, "Ann Arbor, MI", "San Diego-Carlsbad, CA", "B
> oston-Cambridge-Newton, MA-NH", "Bay Area, CA", "Gainesville, FL")
 42.     foreach m in "Gainesville, FL" "Ann Arbor, MI" "San Diego-Carlsbad, CA
> " "Bay Area, CA" "Boston-Cambridge-Newton, MA-NH" {
 43.         sum impact_cite_affl_wt if msa_comb == "`m'", d
 44.         mat row = (r(min) , r(p5) , r(p10), r(p25), r(p50) , r(p75), r(p90
> ) , r(p95), r(max), r(mean) , r(sd))
 45.         sum msa_size if msa_comb == "`m'" 
 46.         mat row = row , r(mean)
 47.         mat city_stats_`samp' = nullmat(city_stats_`samp') \ (row)
 48.     }
 49.     restore
 50.     reghdfe `reg_eq', noabsorb
 51.     local slope = _b[ln_x]
 52.     if "`samp'" == "year" {
 53.         binscatter2  ln_y ln_x ,controls(avg_team_size) ytitle("Log Output
> ") xtitle("Log Cluster Size") legend(on order(- "Slope = `slope'") pos(5) rin
> g(0) lwidth(none))
 54.         *graph export ../output/figures/bs_`samp'.pdf, replace
.     }
 55.     if "`samp'" == "year_firstlast" {
 56.         binscatter2  ln_y ln_x , ytitle("Log Output") xtitle("Log Cluster 
> Size") legend(on order(- "Slope = `slope'") pos(5) ring(0) lwidth(none))
 57.         *graph export ../output/figures/bs_`samp'.pdf, replace
.     }
 58.     foreach fe in "${time} msa field" "${time} msa field field#${time}" "$
> {time} msa field field#${time} msa#field" "${time} msa field field#${time} ms
> a#field inst" "${time} msa field field#${time} msa#field inst athr_id" {
 59.         reghdfe `reg_eq', absorb(`fe') vce(cluster msa)
 60.         mat coef_`samp' = nullmat(coef_`samp'), (`mat_est' \ . \ . \e(N))
 61.         if "`fe'" == "${time} msa field field#${time} msa#field inst athr_
> id" {
 62.             global final_elasticity = _b[ln_x]
 63.         }
 64.         local slope : dis %3.2f _b[ln_x]
 65.         if "`samp'" == "year" {
 66.             binscatter2  ln_y ln_x ,controls(avg_team_size) absorb(year ms
> a field year_field msa_field athr_id) ytitle("Log Output") xtitle("Log Cluste
> r Size") legend(on order(- "Slope = `slope'") pos(5) ring(0) lwidth(none))
 67.             *graph export ../output/figures/final_bs_`samp'.pdf, replace
.         }
 68.         if "`samp'" == "year_firstlast" {
 69.             binscatter2  ln_y ln_x , absorb(year msa field year_field msa_
> field athr_id) ytitle("Log Output") xtitle("Log Cluster Size") legend(on orde
> r(- "Slope = `slope'") pos(5) ring(0) lwidth(none))
 70.             *graph export ../output/figures/final_bs_`samp'.pdf, replace
.         }
 71.     }
 72.     reghdfe ln_y ln_x_econ, absorb(${time} msa field field#${time} field#m
> sa inst athr_id) vce(cluster msa)
 73.     mat econ_`samp' = nullmat(econ_`samp'), (. \ . \ _b[ln_x_econ] \ _se[l
> n_x_econ] \ e(N))
 74.     mat coef_`samp' = nullmat(coef_`samp') , econ_`samp'
 75.     reghdfe `reg_eq', absorb(year msa athr_id field inst) vce(cluster msa)
 76.     mat field_`samp' = nullmat(field_`samp'), (`mat_est' \ e(N))
 77.     reghdfe `reg_eq', absorb(year msa athr_id gen_mesh1 gen_mesh2 inst) vc
> e(cluster msa)
 78.     mat field_`samp' = nullmat(field_`samp'), (`mat_est' \ e(N))
 79. *    mat alt_spec_`samp' = instyr_`samp' , field_`samp'
. /*    reghdfe `reg_eq', absorb(year msa athr_id qualifier_name1 qualifier_nam
> e2 inst) vce(cluster msa)
>     mat field_`samp' = nullmat(field_`samp'), (`mat_est' \ e(N))
>     reghdfe `reg_eq', absorb(year msa athr_id term1 term2 inst) vce(cluster m
> sa)
>     mat field_`samp' = nullmat(field_`samp'), (`mat_est' \ e(N))*/
. end

. 
. program firm_externalities
  1.     syntax, samp(str)
  2.     // create clusters 
.     use if !mi(msa_comb) & !mi(inst_id) using ../external/year_insts/filled_i
> n_panel_year, clear
  3.     bys inst_id msa_comb year athr_id: gen count = _n == 1
  4.     bys inst_id msa_comb year : egen inst_athrs = total(count) 
  5.     drop count 
  6.     bys msa_comb year athr_id: gen count = _n == 1
  7.     bys msa_comb year : egen msa_size = total(count) 
  8.     drop count
  9.     bys inst_id msa_comb year: gen count = _n == 1
 10.     bys msa_comb year: gegen num_insts = total(count)
 11.     contract msa_comb inst_id inst year inst_athrs msa_size
 12.     bys msa_comb year: egen sum_insts = total(inst_athrs)
 13.     assert sum_insts == msa_size
 14.     drop sum_insts _freq
 15.     save ../temp/inst_cluster_size, replace
 16. 
.     use if !mi(msa_comb) & inrange(year, 1945, 2022) using ../external/samp/a
> thr_panel_full_comb_`samp', clear 
 17.     drop msa_size
 18.     merge m:1 inst_id msa_comb year  using ../temp/inst_cluster_size , ass
> ert(2 3) keep(3) nogen
 19.     contract inst_id inst msa_comb year msa_size inst_athrs 
 20.     gisid inst_id msa_comb year
 21.     drop _freq
 22.     gen wo_inst_cluster = msa_size - inst_athrs
 23.     gen ln_wo_inst = ln(wo_inst_cluster)
 24.     gen ln_cluster_diff = ln(msa_size) - ln_wo_inst 
 25.     gen firm_elasticity = ln_cluster_diff * ${final_elasticity}
 26.     drop if mi(firm_elasticity)
 27.     bys msa_comb year: gen num_insts = _N
 28.     drop if num_insts == 1 
 29.     // pick a year and report some top ones . t = 2018
.     preserve
 30.     keep if year == 2018
 31.     gsort -inst_athrs
 32.     li msa_comb inst inst_athrs msa_size firm_elasticity in 1/10
 33.     mkmat firm_elasticity in 1/10, mat(inst_elasticities_`samp')
 34.     sum firm_elasticity
 35.     restore
 36.     bys msa_comb year: egen tot_firm_elasticity = total(firm_elasticity)
 37.     gen perc = firm_elasticity/tot_firm_elasticity*100
 38.     bys msa_comb year: egen tot = sum(perc)
 39.     assert round(tot) == 100
 40.     drop tot
 41.     keep if inlist(msa_comb, "Boston-Cambridge-Newton, MA-NH", "Bay Area, 
> CA", "Washington-Arlington-Alexandria, DC-VA-MD-WV", "Baltimore-Columbia-Tows
> on, MD")
 42.     glevelsof msa_comb, local(city)
 43.     hashsort msa_comb year -perc
 44.     gen group = 1 if msa_comb == "Baltimore-Columbia-Towson, MD" & inst ==
>  "Johns Hopkins University"
 45.     replace group = 2 if msa_comb == "Baltimore-Columbia-Towson, MD" & ins
> t == "University of Maryland, Baltimore"
 46.     replace group = 3 if msa_comb == "Baltimore-Columbia-Towson, MD" & mi(
> group)
 47.     replace group = 1 if msa_comb == "Boston-Cambridge-Newton, MA-NH" & in
> st == "Harvard University"
 48.     replace group = 2 if msa_comb == "Boston-Cambridge-Newton, MA-NH" & in
> st == "Mass General Brigham"
 49.     replace group = 3 if msa_comb == "Boston-Cambridge-Newton, MA-NH" & in
> st == "Massachusetts Institute of Technology"
 50.     replace group = 4 if msa_comb == "Boston-Cambridge-Newton, MA-NH" & mi
> (group)
 51.     replace group = 1 if msa_comb == "Bay Area, CA" & inst == "Stanford Un
> iversity"
 52.     replace group = 2 if msa_comb == "Bay Area, CA" & inst == "University 
> of California, San Francisco"
 53.     replace group = 3 if msa_comb == "Bay Area, CA" & inst == "University 
> of California, Berkeley"
 54.     replace group = 4 if msa_comb == "Bay Area, CA" & mi(group)
 55.     replace group = 1 if msa_comb == "Washington-Arlington-Alexandria, DC-
> VA-MD-WV" & inst == "National Institutes of Health"
 56.     replace group = 2 if msa_comb == "Washington-Arlington-Alexandria, DC-
> VA-MD-WV" & inst == "National Aeronautics and Space Administration"
 57.     replace group = 3 if msa_comb == "Washington-Arlington-Alexandria, DC-
> VA-MD-WV" & mi(group)
 58.     replace inst = "UCSF" if inst == "University of California, San Franci
> sco"
 59.     replace inst = "UC Berkeley" if inst == "University of California, Ber
> keley"
 60.     replace inst = "MIT" if inst == "Massachusetts Institute of Technology
> "
 61.     foreach c in `city' {
 62.         if "`c'" == "Boston-Cambridge-Newton, MA-NH" local suf "bos"
 63.         if "`c'" == "Bay Area, CA" local suf "bay"
 64.         if "`c'" == "Washington-Arlington-Alexandria, DC-VA-MD-WV" local s
> uf "dc"
 65.         if "`c'" == "Baltimore-Columbia-Towson, MD" local suf "balt"
 66.         preserve
 67.         keep if msa_comb == "`c'"
 68.         collapse (sum) perc (firstnm) inst inst_id, by(msa_comb year group
> )
 69.         hashsort msa_comb year -group
 70.         bys year: gen stack_perc = sum(perc)
 71.         local stacklines
 72.         qui xtset group year
 73.         sum group
 74.         local max_grp = r(max)
 75.         qui levelsof group, local(rank_grps)
 76.         local items = `r(r)'
 77.         foreach x of local rank_grps {
 78.             colorpalette carto Teal, intensify(0.85)  n(`items') nograph
 79.             local stacklines `stacklines' area stack_perc year if group ==
>  `x', fcolor("`r(p`x')'") lcolor(white) lwidth(*0.3) ||
 80.         }
 81.         gen labely = . 
 82.         gen rev_group = -group
 83.         if `max_grp' == 4 {
 84.              qui bys year (rev_group): replace labely = perc/2 if group ==
>  4
 85.              qui bys year (rev_group): replace labely = perc/2 + perc[_n-1
> ] if group == 3
 86.              qui bys year (rev_group): replace labely = perc/2 + perc[_n-1
> ] + perc[_n-2] if group == 2
 87.              qui bys year (rev_group): replace labely = perc/2 + perc[_n-1
> ] + perc[_n-2] + perc[_n-3] if group == 1
 88.         }
 89.         if `max_grp' == 3 {
 90.              qui bys year (rev_group): replace labely = perc/2 if group ==
>  3
 91.              qui bys year (rev_group): replace labely = perc/2 + perc[_n-1
> ] if group == 2
 92.              qui bys year (rev_group): replace labely = perc/2 + perc[_n-1
> ] + perc[_n-2] if group == 1
 93.         }
 94.         gen labely_lab = "Everywhere else" if group == `max_grp'
 95.         replace labely_lab = inst if mi(labely_lab)
 96.         local w = 27
 97.         graph tw `stacklines' (scatter labely year if year == 2022, ms(smc
> ircle) ///
>           msize(0.2) mcolor(black%40) mlabsize(vsmall) mlabcolor(black) mlabe
> l(labely_lab)), ///
>           ytitle("Relative Productivity Spillover Effect in Cluster", size(vs
> mall)) xtitle("Year", size(vsmall)) xlabel(1945(2)2022, angle(45) labsize(vsm
> all)) ylabel(0(10)100, labsize(vsmall)) ///
>           graphregion(margin(r+27)) plotregion(margin(zero)) ///
>           legend(off)
 98.         qui graph export ../output/figures/elasticity_trend_`suf'.pdf , re
> place
 99.         restore
100.     }
101.     hashsort inst_id year
102.     tw line firm_elasticity year if inst == "Harvard University", xlab(194
> 5(5)2022, angle(45) labsize(vsmall)) ylab(0.04(0.02)0.16, labsize(vsmall)) xt
> itle("Year", size(vsmall)) ytitle("Harvard University Productivity Externalit
> y", size(vsmall))
103.     graph export ../output/figures/harvard_elasticity_trend.pdf, replace 
104.     tw line firm_elasticity year if inst == "Massachusetts Institute of Te
> chnology", xlab(1945(5)2022, angle(45) labsize(vsmall)) ylab(0.01(0.01)0.05, 
> labsize(vsmall)) xtitle("Year", size(vsmall)) ytitle("MIT Productivity Extern
> ality", size(vsmall))
105.     graph export ../output/figures/mit_elasticity_trend.pdf, replace 
106.     tw line firm_elasticity year if inst == "Mass General Brigham", xlab(1
> 945(5)2022, angle(45) labsize(vsmall)) ylab(0.01(0.01)0.05, labsize(vsmall)) 
> xtitle("Year", size(vsmall)) ytitle("MGH Productivity Externality", size(vsma
> ll))
107.     graph export ../output/figures/mgh_elasticity_trend.pdf, replace 
108.     
.     hashsort inst_id year
109.     tw line firm_elasticity year if inst == "Stanford University", xlab(19
> 45(5)2022, angle(45) labsize(vsmall)) ylab(0.04(0.01)0.08, labsize(vsmall)) x
> title("Year", size(vsmall)) ytitle("Stanford University Productivity External
> ity", size(vsmall))
110.     graph export ../output/figures/stanford_elasticity_trend.pdf, replace 
111. 
.     hashsort inst_id year
112.     tw line firm_elasticity year if inst == "National Institutes of Health
> ", xlab(1945(5)2022, angle(45) labsize(vsmall)) ylab(0.02(0.02)0.12, labsize(
> vsmall)) xtitle("Year", size(vsmall)) ytitle("NIH Productivity Externality", 
> size(vsmall))
113.     graph export ../output/figures/nih_elasticity_trend.pdf, replace 
114. 
.     hashsort inst_id year
115.     tw line firm_elasticity year if inst == "Johns Hopkins University", xl
> ab(1945(5)2022, angle(45) labsize(vsmall)) ylab(0.20(0.02)0.30, labsize(vsmal
> l)) xtitle("Year", size(vsmall)) ytitle("Johns Hopkins University Productivit
> y Externality", size(vsmall))
116.     graph export ../output/figures/jhu_elasticity_trend.pdf, replace 
117. 
.     hashsort inst_id year
118.     tw line firm_elasticity year if inst == "University of Michigan–Ann Ar
> bor", xlab(1945(5)2022, angle(45) labsize(vsmall)) ylab(0.50(0.05)0.80, labsi
> ze(vsmall)) xtitle("Year", size(vsmall)) ytitle("University of Michigan-Ann A
> rbor Productivity Externality", size(vsmall))
119.     graph export ../output/figures/umich_elasticity_trend.pdf, replace 
120. end

. 
. program output_tables
  1.     syntax, samp(str) 
  2.     foreach file in top_10clus top_30clus coef field city_stats { //inst_e
> lasticities { //econ_coef { 
  3.          qui matrix_to_txt, saving("../output/tables/`file'_`samp'.txt") m
> atrix(`file'_`samp') ///
>            title(<tab:`file'_`samp'>) format(%20.4f) replace
  4.     }
  5. end

. ** 
. main
(file ../temp/econs_cluster.dta not found)
file ../temp/econs_cluster.dta saved
  387,349
N = 387,349; 195,452 unbalanced groups of sizes 1 to 48
(4 missing values generated)
(295,524 missing values generated)
(311,702 observations deleted)

     +-----------------------------------------------------------------------+
     |                                       msa_comb    msa_size   cluste~r |
     |-----------------------------------------------------------------------|
  1. |          New York-Newark-Jersey City, NY-NJ-PA   24574.615   .0218465 |
  2. |                 Boston-Cambridge-Newton, MA-NH   23470.668   .0208778 |
  3. |   Washington-Arlington-Alexandria, DC-VA-MD-WV   20655.139   .0183335 |
  4. |                                   Bay Area, CA   17407.324   .0155113 |
  5. |             Los Angeles-Long Beach-Anaheim, CA   10457.835    .009297 |
     |-----------------------------------------------------------------------|
  6. |    Philadelphia-Camden-Wilmington, PA-NJ-DE-MD   9180.1938   .0081641 |
  7. |             Chicago-Naperville-Elgin, IL-IN-WI   8683.6416    .007716 |
  8. |                     Research Triangle Park, NC   7780.3341   .0069105 |
  9. |                         San Diego-Carlsbad, CA   7765.8758   .0068923 |
 10. |           Houston-The Woodlands-Sugar Land, TX   7753.8246   .0068807 |
     |-----------------------------------------------------------------------|
 11. |                  Baltimore-Columbia-Towson, MD    7425.368    .006595 |
 12. |                    Seattle-Tacoma-Bellevue, WA   6832.9514   .0060904 |
 13. |              Atlanta-Sandy Springs-Roswell, GA   6077.6528   .0053945 |
 14. |                                  Ann Arbor, MI   4288.8163   .0038162 |
 15. |                                 Pittsburgh, PA   3981.5679   .0035328 |
     |-----------------------------------------------------------------------|
 16. |                               St. Louis, MO-IL   3913.9849   .0034869 |
 17. |                          New Haven-Milford, CT   3777.1117   .0033736 |
 18. |                                    Madison, WI   3304.9202   .0029339 |
 19. |        Minneapolis-St. Paul-Bloomington, MN-WI   3244.9601   .0028834 |
 20. |                                     Ithaca, NY   3225.3073   .0028696 |
     |-----------------------------------------------------------------------|
 21. |                Dallas-Fort Worth-Arlington, TX   3053.1218   .0027181 |
 22. |        Sacramento--Roseville--Arden-Arcade, CA   2966.2643   .0026334 |
 23. |                           Cleveland-Elyria, OH   2961.7283   .0026208 |
 24. | Nashville-Davidson--Murfreesboro--Franklin, TN   2836.6628   .0025188 |
 25. |                                Gainesville, FL     2607.18   .0023162 |
     |-----------------------------------------------------------------------|
 26. |                     Denver-Aurora-Lakewood, CO   2558.7627   .0022771 |
 27. |                                   Columbus, OH   2421.6814   .0021589 |
 28. |      Miami-Fort Lauderdale-West Palm Beach, FL   2279.2645    .002024 |
 29. |                           Cincinnati, OH-KY-IN   2225.1257   .0019737 |
 30. |                    Phoenix-Mesa-Scottsdale, AZ   2029.8019   .0018053 |
     +-----------------------------------------------------------------------+

    Result                      Number of obs
    -----------------------------------------
    Not matched                           100
        from master                       100  
        from using                          0  

    Matched                               204  
    -----------------------------------------
(100 missing values generated)
(304 missing values generated)
variable msa_lab was str1 now str22
(1 real change made)
(1 real change made)
(1 real change made)
variable msa_lab was str22 now str39
(1 real change made)
variable msa_lab was str39 now str44
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(0 real changes made)
(100 missing values generated)
(3 real changes made)
(4 real changes made)
(obs=204)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9420   1.0000


      Source |       SS           df       MS      Number of obs   =       204
-------------+----------------------------------   F(1, 202)       =   1592.66
       Model |  1.0043e+09         1  1.0043e+09   Prob > F        =    0.0000
    Residual |   127380961       202  630598.818   R-squared       =    0.8874
-------------+----------------------------------   Adj R-squared   =    0.8869
       Total |  1.1317e+09       203  5574934.24   Root MSE        =     794.1

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   23.74622   .5950216    39.91   0.000     22.57297    24.91947
       _cons |   222.1969   59.24791     3.75   0.000     105.3732    339.0206
------------------------------------------------------------------------------
file ../output/figures/econ_v_ls_year_firstlast.pdf saved as PDF format
(8 real changes made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(2 real changes made)
(5 real changes made)
file ../output/figures/pat_prod_scatter_year_firstlast.pdf saved as PDF
    format
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_state_shp.dta created
  file usa_state.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           296,043  (_merge==3)
    -----------------------------------------
STATEFP: all characters numeric; replaced as byte
(9,030 observations deleted)
(344 observations deleted)
(116,302 real changes made)
(116,302 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
(166,263 real changes made)
(166,263 real changes made)
file usa_state_shp_clean.dta saved
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_msa_shp.dta created
  file usa_msa.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           408,279  
    -----------------------------------------
CBSAFP: all characters numeric; replaced as long
(5,831 observations deleted)
(0 observations deleted)
(7,520 real changes made)
(7,520 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
file usa_msa_shp_clean.dta saved
(variable msatitle was str46, now str50 to accommodate using data's values)
(variable city was str35, now str42 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         4,357
        from master                     4,357  
        from using                          0  

    Matched                           382,992  
    -----------------------------------------
(36,087 real changes made)
(0 real changes made)
(32 real changes made)
(file ../temp/map_samp.dta not found)
file ../temp/map_samp.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                           639
        from master                       639  
        from using                          0  

    Matched                               306  
    -----------------------------------------
file ../output/figures/impact_cite_affl_wt_map_year_firstlast.pdf saved as
    PDF format
(0 observations deleted)
(4 missing values generated)
(295,524 missing values generated)
(file ../temp/econ_yr_cluster.dta not found)
file ../temp/econ_yr_cluster.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,643  
    -----------------------------------------
(obs=4,643)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9209   1.0000


      Source |       SS           df       MS      Number of obs   =     4,643
-------------+----------------------------------   F(1, 4641)      =  25917.69
       Model |  4.4857e+10         1  4.4857e+10   Prob > F        =    0.0000
    Residual |  8.0324e+09     4,641  1730742.49   R-squared       =    0.8481
-------------+----------------------------------   Adj R-squared   =    0.8481
       Total |  5.2889e+10     4,642  11393629.3   Root MSE        =    1315.6

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   21.86567   .1358203   160.99   0.000      21.5994    22.13194
       _cons |   144.6771   22.10934     6.54   0.000     101.3322    188.0219
------------------------------------------------------------------------------
(4,643 missing values generated)
variable msa_lab was str1 now str27
(1 real change made)
(0 real changes made)
(1 real change made)
(0 real changes made)
variable msa_lab was str27 now str42
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        44,215
        from master                    44,215  
        from using                          0  

    Matched                           343,134  
    -----------------------------------------
(4 real changes made)
(14 real changes made)
(44,215 missing values generated)
(311,702 observations deleted)
(59,562 observations deleted)

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0009715       .0007287
 5%     .0019431       .0007287
10%     .0029146       .0008327       Obs                 750
25%     .0048577       .0008327       Sum of wgt.         750

50%     .0087438                      Mean           .2401756
                        Largest       Std. dev.      1.416517
75%     .0187367       9.762052
90%      .122679       13.39055       Variance        2.00652
95%     .9343773          21.77       Skewness       11.37758
99%     4.385993          21.77       Kurtosis       157.1436

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |        750     2607.18    113.3333       2309       2699

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0009715       .0003643
 5%     .0019431       .0006477
10%     .0032789       .0008744       Obs               1,045
25%      .006315       .0008744       Sum of wgt.       1,045

50%     .0150507                      Mean           1.088912
                        Largest       Std. dev.      4.572572
75%     .1386056       45.32907
90%     2.286467       50.75241       Variance       20.90841
95%     5.018153       53.93194       Skewness       8.035797
99%     20.50421       58.90344       Kurtosis       80.41749

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      1,045    4288.816    219.8951       3739       4472

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0011658       .0002915
 5%     .0025908       .0002915
10%     .0040804       .0004858       Obs               2,286
25%     .0091081       .0005829       Sum of wgt.       2,286

50%     .0672253                      Mean           2.094016
                        Largest       Std. dev.      6.105439
75%     1.788177       62.57673
90%     5.144878       62.57673       Variance       37.27638
95%      9.36664       63.71263       Skewness       9.227076
99%     30.12553       141.9786       Kurtosis       149.3079

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      2,286    7765.876    499.4431       6580       8204

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0009715       .0003238
 5%     .0026231       .0004164
10%     .0043719       .0004858       Obs               5,258
25%     .0099097       .0004858       Sum of wgt.       5,258

50%     .5537273                      Mean           3.154065
                        Largest       Std. dev.      11.27988
75%     2.775583       210.2375
90%     7.798951       212.6107       Variance       127.2356
95%     13.55013       365.2105       Skewness       18.12352
99%     32.32021       365.2105       Kurtosis       484.8849

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      5,258    17407.32    475.3964      16364      17911

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%      .001093       .0002915
 5%     .0029146       .0002915
10%     .0043719       .0002915       Obs               6,746
25%     .0097153       .0002915       Sum of wgt.       6,746

50%     .4456066                      Mean           3.086634
                        Largest       Std. dev.      8.351113
75%     2.887171       149.8384
90%     7.569002       164.7983       Variance        69.7411
95%     14.12208       164.7983       Skewness       9.442737
99%     36.42416       210.9612       Kurtosis       154.0751

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      6,746    23470.67     957.504      20878      24031
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    387,349
Absorbing 1 HDFE group                            F(   1, 387347) =   21745.61
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.0532
                                                  Adj R-squared   =     0.0532
                                                  Within R-sq.    =     0.0532
                                                  Root MSE        =     2.2801

------------------------------------------------------------------------------
        ln_y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .3878002   .0026298   147.46   0.000     .3826459    .3929545
       _cons |  -6.281052    .021759  -288.66   0.000    -6.323699   -6.238405
------------------------------------------------------------------------------
(dropped 30 singleton observations)
(MWFE estimator converged in 7 iterations)

HDFE Linear regression                            Number of obs   =    387,319
Absorbing 3 HDFE groups                           F(   1,    273) =       2.21
Statistics robust to heteroskedasticity           Prob > F        =     0.1385
                                                  R-squared       =     0.1650
                                                  Adj R-squared   =     0.1642
                                                  Within R-sq.    =     0.0003
Number of clusters (msa)     =        274         Root MSE        =     2.1423

                                  (Std. err. adjusted for 274 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1860924   .1252481     1.49   0.138    -.0604826    .4326673
       _cons |  -4.635946    1.02158    -4.54   0.000    -6.647121   -2.624771
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       274         274           0    *|
       field |         5           1           4     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 33 singleton observations)
(MWFE estimator converged in 5 iterations)

HDFE Linear regression                            Number of obs   =    387,316
Absorbing 4 HDFE groups                           F(   1,    273) =       2.53
Statistics robust to heteroskedasticity           Prob > F        =     0.1129
                                                  R-squared       =     0.2063
                                                  Adj R-squared   =     0.2049
                                                  Within R-sq.    =     0.0003
Number of clusters (msa)     =        274         Root MSE        =     2.0894

                                  (Std. err. adjusted for 274 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1862163   .1170817     1.59   0.113    -.0442815    .4167141
       _cons |   -4.63695   .9549717    -4.86   0.000    -6.516995   -2.756905
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       274         274           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 147 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =    387,202
Absorbing 5 HDFE groups                           F(   1,    265) =       2.40
Statistics robust to heteroskedasticity           Prob > F        =     0.1225
                                                  R-squared       =     0.2128
                                                  Adj R-squared   =     0.2095
                                                  Within R-sq.    =     0.0002
Number of clusters (msa)     =        266         Root MSE        =     2.0835

                                  (Std. err. adjusted for 266 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1803814   .1164323     1.55   0.123    -.0488688    .4096316
       _cons |  -4.589482   .9498573    -4.83   0.000    -6.459709   -2.719254
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       266         266           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
    msa#field |       965         965           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 1562 singleton observations)
(MWFE estimator converged in 15 iterations)

HDFE Linear regression                            Number of obs   =    385,787
Absorbing 6 HDFE groups                           F(   1,    263) =       2.15
Statistics robust to heteroskedasticity           Prob > F        =     0.1437
                                                  R-squared       =     0.2595
                                                  Adj R-squared   =     0.2510
                                                  Within R-sq.    =     0.0002
Number of clusters (msa)     =        264         Root MSE        =     2.0280

                                  (Std. err. adjusted for 264 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1830166   .1247943     1.47   0.144    -.0627065    .4287398
       _cons |  -4.609123   1.018221    -4.53   0.000    -6.614026   -2.604221
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       264         264           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
    msa#field |       956         956           0    *|
         inst |      2754        2754           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 132421 singleton observations)
(MWFE estimator converged in 49 iterations)

HDFE Linear regression                            Number of obs   =    254,928
Absorbing 7 HDFE groups                           F(   1,    223) =       4.83
Statistics robust to heteroskedasticity           Prob > F        =     0.0290
                                                  R-squared       =     0.6548
                                                  Adj R-squared   =     0.5315
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        224         Root MSE        =     1.6078

                                  (Std. err. adjusted for 224 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1573125   .0715896     2.20   0.029     .0162337    .2983912
       _cons |  -4.269421   .5856007    -7.29   0.000     -5.42344   -3.115401
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       224         224           0    *|
        field |         5           1           4     |
   field#year |       365          78         287    ?|
    msa#field |       832         832           0    *|
         inst |      1839        1839           0    *|
      athr_id |     63873           1       63872    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 120281 singleton observations)
(MWFE estimator converged in 43 iterations)

HDFE Linear regression                            Number of obs   =    222,853
Absorbing 7 HDFE groups                           F(   1,    123) =       2.61
Statistics robust to heteroskedasticity           Prob > F        =     0.1085
                                                  R-squared       =     0.6557
                                                  Adj R-squared   =     0.5323
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        124         Root MSE        =     1.6277

                                  (Std. err. adjusted for 124 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
   ln_x_econ |   .0580087   .0358843     1.62   0.109    -.0130221    .1290394
       _cons |  -3.181721   .1849095   -17.21   0.000    -3.547738   -2.815704
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        77           0          77     |
          msa |       124         124           0    *|
        field |         5           1           4     |
   field#year |       362          77         285    ?|
    field#msa |       543         543           0    *|
         inst |      1523        1523           0    *|
      athr_id |     56209           1       56208    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 132270 singleton observations)
(MWFE estimator converged in 46 iterations)

HDFE Linear regression                            Number of obs   =    255,079
Absorbing 5 HDFE groups                           F(   1,    234) =       3.38
Statistics robust to heteroskedasticity           Prob > F        =     0.0672
                                                  R-squared       =     0.6459
                                                  Adj R-squared   =     0.5220
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        235         Root MSE        =     1.6239

                                  (Std. err. adjusted for 235 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1316148   .0715741     1.84   0.067    -.0093971    .2726267
       _cons |   -4.05939    .585314    -6.94   0.000    -5.212548   -2.906231
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       235         235           0    *|
     athr_id |     63923           1       63922     |
       field |         5           1           4    ?|
        inst |      1854        1854           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 101256 singleton observations)
(MWFE estimator converged in 76 iterations)

HDFE Linear regression                            Number of obs   =    190,854
Absorbing 6 HDFE groups                           F(   1,    220) =       2.71
Statistics robust to heteroskedasticity           Prob > F        =     0.1008
                                                  R-squared       =     0.6834
                                                  Adj R-squared   =     0.5234
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        221         Root MSE        =     1.6486

                                  (Std. err. adjusted for 221 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1587797   .0963649     1.65   0.101    -.0311368    .3486962
       _cons |  -3.928324   .8041051    -4.89   0.000    -5.513059    -2.34359
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       221         221           0    *|
     athr_id |     48146           1       48145     |
   gen_mesh1 |      6709         100        6609    ?|
   gen_mesh2 |      7625         200        7425    ?|
        inst |      1565        1565           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
file ../temp/econs_cluster.dta saved
  1,011,481
N = 1,011,481; 466,387 unbalanced groups of sizes 1 to 54
(20 missing values generated)
(752,867 missing values generated)
(716,905 observations deleted)

     +-----------------------------------------------------------------------+
     |                                       msa_comb    msa_size   cluste~r |
     |-----------------------------------------------------------------------|
  1. |          New York-Newark-Jersey City, NY-NJ-PA   24459.467   .0218124 |
  2. |                 Boston-Cambridge-Newton, MA-NH   23399.807   .0208554 |
  3. |   Washington-Arlington-Alexandria, DC-VA-MD-WV    20507.11    .018256 |
  4. |                                   Bay Area, CA   17384.235   .0155557 |
  5. |             Los Angeles-Long Beach-Anaheim, CA   10417.354   .0092809 |
     |-----------------------------------------------------------------------|
  6. |    Philadelphia-Camden-Wilmington, PA-NJ-DE-MD   9148.5175   .0081497 |
  7. |             Chicago-Naperville-Elgin, IL-IN-WI   8625.6659   .0076829 |
  8. |                     Research Triangle Park, NC   7739.6461   .0068922 |
  9. |           Houston-The Woodlands-Sugar Land, TX   7697.3602   .0068478 |
 10. |                         San Diego-Carlsbad, CA   7696.1599   .0068494 |
     |-----------------------------------------------------------------------|
 11. |                  Baltimore-Columbia-Towson, MD   7377.9843   .0065692 |
 12. |                    Seattle-Tacoma-Bellevue, WA   6826.0491   .0061126 |
 13. |              Atlanta-Sandy Springs-Roswell, GA    6026.583   .0053709 |
 14. |                                  Ann Arbor, MI   4276.1119   .0038088 |
 15. |                                 Pittsburgh, PA   3963.3681   .0035224 |
     |-----------------------------------------------------------------------|
 16. |                               St. Louis, MO-IL   3893.8212   .0034807 |
 17. |                          New Haven-Milford, CT   3764.6696   .0033738 |
 18. |                                    Madison, WI   3278.1813   .0029153 |
 19. |        Minneapolis-St. Paul-Bloomington, MN-WI   3227.9011   .0028744 |
 20. |                                     Ithaca, NY   3203.4607   .0028597 |
     |-----------------------------------------------------------------------|
 21. |                Dallas-Fort Worth-Arlington, TX   3044.6065   .0027158 |
 22. |        Sacramento--Roseville--Arden-Arcade, CA   2957.5287   .0026273 |
 23. |                           Cleveland-Elyria, OH   2929.8057   .0025998 |
 24. | Nashville-Davidson--Murfreesboro--Franklin, TN   2812.2986   .0025038 |
 25. |                                Gainesville, FL   2605.6175   .0023139 |
     |-----------------------------------------------------------------------|
 26. |                     Denver-Aurora-Lakewood, CO   2557.7914    .002279 |
 27. |                                   Columbus, OH   2420.4582   .0021554 |
 28. |      Miami-Fort Lauderdale-West Palm Beach, FL   2271.1229   .0020218 |
 29. |                           Cincinnati, OH-KY-IN   2201.7788   .0019579 |
 30. |                    Phoenix-Mesa-Scottsdale, AZ   2027.0769   .0018068 |
     +-----------------------------------------------------------------------+

    Result                      Number of obs
    -----------------------------------------
    Not matched                           130
        from master                       130  
        from using                          0  

    Matched                               206  
    -----------------------------------------
(76 missing values generated)
(336 missing values generated)
variable msa_lab was str1 now str22
(1 real change made)
(1 real change made)
(1 real change made)
variable msa_lab was str22 now str39
(1 real change made)
variable msa_lab was str39 now str44
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(0 real changes made)
(130 missing values generated)
(3 real changes made)
(4 real changes made)
(obs=206)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9418   1.0000


      Source |       SS           df       MS      Number of obs   =       206
-------------+----------------------------------   F(1, 204)       =   1600.60
       Model |  1.3281e+09         1  1.3281e+09   Prob > F        =    0.0000
    Residual |   169264120       204  829726.076   R-squared       =    0.8870
-------------+----------------------------------   Adj R-squared   =    0.8864
       Total |  1.4973e+09       205  7304029.55   Root MSE        =    910.89

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   27.28953   .6821097    40.01   0.000     25.94464    28.63442
       _cons |   225.4649   67.58902     3.34   0.001     92.20224    358.7275
------------------------------------------------------------------------------
file ../output/figures/econ_v_ls_year.pdf saved as PDF format
(8 real changes made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(2 real changes made)
(5 real changes made)
file ../output/figures/pat_prod_scatter_year.pdf saved as PDF format
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_state_shp.dta created
  file usa_state.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           296,043  (_merge==3)
    -----------------------------------------
STATEFP: all characters numeric; replaced as byte
(9,030 observations deleted)
(344 observations deleted)
(116,302 real changes made)
(116,302 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
(166,263 real changes made)
(166,263 real changes made)
file usa_state_shp_clean.dta saved
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_msa_shp.dta created
  file usa_msa.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           408,279  
    -----------------------------------------
CBSAFP: all characters numeric; replaced as long
(5,831 observations deleted)
(0 observations deleted)
(7,520 real changes made)
(7,520 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
file usa_msa_shp_clean.dta saved
(variable msatitle was str46, now str50 to accommodate using data's values)
(variable city was str35, now str42 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        10,674
        from master                    10,674  
        from using                          0  

    Matched                         1,000,807  
    -----------------------------------------
(94,845 real changes made)
(0 real changes made)
(74 real changes made)
file ../temp/map_samp.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                           607
        from master                       607  
        from using                          0  

    Matched                               338  
    -----------------------------------------
file ../output/figures/impact_cite_affl_wt_map_year.pdf saved as PDF format
(0 observations deleted)
(20 missing values generated)
(752,867 missing values generated)
file ../temp/econ_yr_cluster.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,752  
    -----------------------------------------
(obs=4,752)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9214   1.0000


      Source |       SS           df       MS      Number of obs   =     4,752
-------------+----------------------------------   F(1, 4750)      =  26695.73
       Model |  4.5163e+10         1  4.5163e+10   Prob > F        =    0.0000
    Residual |  8.0358e+09     4,750     1691752   R-squared       =    0.8489
-------------+----------------------------------   Adj R-squared   =    0.8489
       Total |  5.3198e+10     4,751  11197300.7   Root MSE        =    1300.7

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   21.88237   .1339286   163.39   0.000     21.61981    22.14493
       _cons |   134.4605   21.55236     6.24   0.000     92.20786    176.7131
------------------------------------------------------------------------------
(4,752 missing values generated)
variable msa_lab was str1 now str27
(1 real change made)
(0 real changes made)
(1 real change made)
(0 real changes made)
variable msa_lab was str27 now str42
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

    Result                      Number of obs
    -----------------------------------------
    Not matched                       113,456
        from master                   113,456  
        from using                          0  

    Matched                           898,025  
    -----------------------------------------
(20 real changes made)
(19 real changes made)
(113,456 missing values generated)
(716,905 observations deleted)
(226,604 observations deleted)

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0002695       .0001123
 5%     .0005839       .0001217
10%     .0008342       .0001825       Obs               2,426
25%     .0017302       .0001946       Sum of wgt.       2,426

50%     .0035036                      Mean           .0837776
                        Largest       Std. dev.      .3261719
75%     .0105948       4.200923
90%     .1615954       4.479639       Variance       .1063881
95%     .4359131       4.583356       Skewness       7.795357
99%     1.739424       4.925981       Kurtosis       84.65092

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      2,426    2605.617    111.5942       2299       2699

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0002781       .0001043
 5%     .0006423       .0001043
10%     .0010093       .0001043       Obs               4,165
25%     .0021689       .0001043       Sum of wgt.       4,165

50%      .007591                      Mean           .2707681
                        Largest       Std. dev.      .9429667
75%     .1913198       11.16763
90%     .6152898       11.23673       Variance       .8891863
95%     1.505881       20.87635       Skewness       15.58626
99%     3.296878       33.24571       Kurtosis       435.2924

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      4,165    4276.112    215.2417       3723       4472

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%      .000365       .0000811
 5%     .0008342       .0000865
10%     .0014274       .0000973       Obs               9,704
25%     .0043164       .0000973       Sum of wgt.       9,704

50%     .1148984                      Mean           .4756393
                        Largest       Std. dev.      1.200474
75%     .4345627       21.41708
90%      1.13134       21.41708       Variance       1.441139
95%     2.026393       28.23441       Skewness       7.823901
99%     5.610163       28.23441       Kurtosis       108.5571

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      9,704     7696.16    525.3184       6483       8204

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0002781       .0000313
 5%     .0007786       .0000313
10%     .0012976       .0000313       Obs              22,090
25%     .0045699       .0000649       Sum of wgt.      22,090

50%     .1893047                      Mean           .6926937
                        Largest       Std. dev.      3.146119
75%     .6231542       181.8125
90%     1.522115       181.8125       Variance       9.898066
95%     2.662894       181.8125       Skewness       43.79893
99%     7.478961       222.8141       Kurtosis       2637.253

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |     22,090    17384.23    503.3283      16236      17911

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0003128       .0000313
 5%     .0008342       .0000313
10%     .0013625       .0000531       Obs              29,587
25%     .0047088       .0000649       Sum of wgt.      29,587

50%     .1866313                      Mean           .6381044
                        Largest       Std. dev.      1.904737
75%      .596436       79.58681
90%     1.532119       79.58681       Variance       3.628025
95%     2.496114       79.59102       Skewness       18.12258
99%      7.18517       95.17311       Kurtosis       616.0096

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |     29,587    23399.81    992.0993      20724      24031
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =  1,011,481
Absorbing 1 HDFE group                            F(   1,1011479) =   32088.10
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.0307
                                                  Adj R-squared   =     0.0307
                                                  Within R-sq.    =     0.0307
                                                  Root MSE        =     2.3855

------------------------------------------------------------------------------
        ln_y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .3100237   .0017307   179.13   0.000     .3066316    .3134158
       _cons |  -6.355683   .0146577  -433.61   0.000    -6.384411   -6.326954
------------------------------------------------------------------------------
(dropped 18 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =  1,011,463
Absorbing 3 HDFE groups                           F(   1,    317) =       1.63
Statistics robust to heteroskedasticity           Prob > F        =     0.2021
                                                  R-squared       =     0.1365
                                                  Adj R-squared   =     0.1362
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        318         Root MSE        =     2.2520

                                  (Std. err. adjusted for 318 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1407611     .11012     1.28   0.202    -.0758973    .3574194
       _cons |  -4.941061   .9203516    -5.37   0.000    -6.751831   -3.130292
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       318         318           0    *|
       field |         5           1           4     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 21 singleton observations)
(MWFE estimator converged in 5 iterations)

HDFE Linear regression                            Number of obs   =  1,011,460
Absorbing 4 HDFE groups                           F(   1,    317) =       1.95
Statistics robust to heteroskedasticity           Prob > F        =     0.1640
                                                  R-squared       =     0.1739
                                                  Adj R-squared   =     0.1734
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        318         Root MSE        =     2.2030

                                  (Std. err. adjusted for 318 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |    .144198   .1033612     1.40   0.164    -.0591625    .3475586
       _cons |  -4.969785   .8638638    -5.75   0.000    -6.669416   -3.270154
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       318         318           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 150 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =  1,011,331
Absorbing 5 HDFE groups                           F(   1,    308) =       2.38
Statistics robust to heteroskedasticity           Prob > F        =     0.1240
                                                  R-squared       =     0.1803
                                                  Adj R-squared   =     0.1788
                                                  Within R-sq.    =     0.0002
Number of clusters (msa)     =        309         Root MSE        =     2.1958

                                  (Std. err. adjusted for 309 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1973957   .1279708     1.54   0.124    -.0544119    .4492033
       _cons |  -5.414475   1.069648    -5.06   0.000    -7.519217   -3.309732
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       309         309           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
    msa#field |      1180        1180           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 2044 singleton observations)
(MWFE estimator converged in 16 iterations)

HDFE Linear regression                            Number of obs   =  1,009,437
Absorbing 6 HDFE groups                           F(   1,    304) =       1.42
Statistics robust to heteroskedasticity           Prob > F        =     0.2339
                                                  R-squared       =     0.2329
                                                  Adj R-squared   =     0.2278
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =        305         Root MSE        =     2.1291

                                  (Std. err. adjusted for 305 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1460733   .1224675     1.19   0.234    -.0949181    .3870646
       _cons |  -4.984099   1.023763    -4.87   0.000    -6.998657    -2.96954
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       305         305           0    *|
        field |         5           1           4     |
   field#year |       374          78         296    ?|
    msa#field |      1162        1162           0    *|
         inst |      4848        4848           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 284485 singleton observations)
(MWFE estimator converged in 45 iterations)

HDFE Linear regression                            Number of obs   =    726,996
Absorbing 7 HDFE groups                           F(   1,    259) =       2.16
Statistics robust to heteroskedasticity           Prob > F        =     0.1432
                                                  R-squared       =     0.5878
                                                  Adj R-squared   =     0.4437
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        260         Root MSE        =     1.8045

                                  (Std. err. adjusted for 260 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .1160335   .0790108     1.47   0.143    -.0395519    .2716189
       _cons |  -4.565915   .6635766    -6.88   0.000    -5.872607   -3.259223
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       260         260           0    *|
        field |         5           1           4     |
   field#year |       365          78         287    ?|
    msa#field |      1019        1019           0    *|
         inst |      3367        3367           0    *|
      athr_id |    183374           1      183373    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 261052 singleton observations)
(MWFE estimator converged in 42 iterations)

HDFE Linear regression                            Number of obs   =    636,973
Absorbing 7 HDFE groups                           F(   1,    132) =       2.42
Statistics robust to heteroskedasticity           Prob > F        =     0.1225
                                                  R-squared       =     0.5887
                                                  Adj R-squared   =     0.4427
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        133         Root MSE        =     1.8191

                                  (Std. err. adjusted for 133 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
   ln_x_econ |   .0739209   .0475561     1.55   0.122    -.0201497    .1679915
       _cons |  -3.876478   .2501474   -15.50   0.000    -4.371294   -3.381662
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        77           0          77     |
          msa |       133         133           0    *|
        field |         5           1           4     |
   field#year |       362          77         285    ?|
    field#msa |       608         608           0    *|
         inst |      2799        2799           0    *|
      athr_id |    163046           1      163045    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 284293 singleton observations)
(MWFE estimator converged in 45 iterations)

HDFE Linear regression                            Number of obs   =    727,188
Absorbing 5 HDFE groups                           F(   1,    272) =       1.23
Statistics robust to heteroskedasticity           Prob > F        =     0.2686
                                                  R-squared       =     0.5775
                                                  Adj R-squared   =     0.4310
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        273         Root MSE        =     1.8248

                                  (Std. err. adjusted for 273 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0843056   .0760548     1.11   0.269    -.0654252    .2340364
       _cons |  -4.299541     .63866    -6.73   0.000    -5.556886   -3.042196
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       273         273           0    *|
     athr_id |    183427           1      183426     |
       field |         5           1           4    ?|
        inst |      3393        3393           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 215449 singleton observations)
(MWFE estimator converged in 57 iterations)

HDFE Linear regression                            Number of obs   =    607,532
Absorbing 6 HDFE groups                           F(   1,    261) =       0.21
Statistics robust to heteroskedasticity           Prob > F        =     0.6497
                                                  R-squared       =     0.6328
                                                  Adj R-squared   =     0.4820
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        262         Root MSE        =     1.7712

                                  (Std. err. adjusted for 262 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0358524   .0788489     0.45   0.650    -.1194085    .1911134
       _cons |  -3.705877    .670233    -5.53   0.000    -5.025629   -2.386124
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       262         262           0    *|
     athr_id |    153775           1      153774     |
   gen_mesh1 |      9355          61        9294    ?|
   gen_mesh2 |     10477         134       10343    ?|
        inst |      3060        3060           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
file ../temp/econs_cluster.dta saved
  103,026
N = 103,026; 60,482 unbalanced groups of sizes 1 to 41
(4 missing values generated)
(68,197 missing values generated)
(91,265 observations deleted)

     +-----------------------------------------------------------------------+
     |                                       msa_comb    msa_size   cluste~r |
     |-----------------------------------------------------------------------|
  1. |          New York-Newark-Jersey City, NY-NJ-PA   24451.644   .0218185 |
  2. |                 Boston-Cambridge-Newton, MA-NH   23396.085   .0208593 |
  3. |   Washington-Arlington-Alexandria, DC-VA-MD-WV   20471.474   .0182295 |
  4. |                                   Bay Area, CA   17429.253   .0155719 |
  5. |             Los Angeles-Long Beach-Anaheim, CA    10396.63   .0092742 |
     |-----------------------------------------------------------------------|
  6. |    Philadelphia-Camden-Wilmington, PA-NJ-DE-MD   9104.4033    .008132 |
  7. |             Chicago-Naperville-Elgin, IL-IN-WI   8550.8261   .0076472 |
  8. |                     Research Triangle Park, NC   7717.4477   .0068809 |
  9. |           Houston-The Woodlands-Sugar Land, TX   7711.7536   .0068568 |
 10. |                         San Diego-Carlsbad, CA   7699.2065    .006851 |
     |-----------------------------------------------------------------------|
 11. |                  Baltimore-Columbia-Towson, MD    7412.177   .0065865 |
 12. |                    Seattle-Tacoma-Bellevue, WA   6835.4177   .0061252 |
 13. |              Atlanta-Sandy Springs-Roswell, GA   5989.9789   .0053616 |
 14. |                                  Ann Arbor, MI   4284.5463   .0038105 |
 15. |                               St. Louis, MO-IL    3912.445   .0034885 |
     |-----------------------------------------------------------------------|
 16. |                                 Pittsburgh, PA   3835.4744   .0034428 |
 17. |                          New Haven-Milford, CT   3771.6098   .0033848 |
 18. |                                    Madison, WI      3279.5   .0029143 |
 19. |        Minneapolis-St. Paul-Bloomington, MN-WI   3214.2931   .0028748 |
 20. |                                     Ithaca, NY   3194.3699   .0028585 |
     |-----------------------------------------------------------------------|
 21. |                Dallas-Fort Worth-Arlington, TX   3060.5887   .0027224 |
 22. |        Sacramento--Roseville--Arden-Arcade, CA   2999.5593   .0026459 |
 23. |                           Cleveland-Elyria, OH    2960.806   .0026183 |
 24. | Nashville-Davidson--Murfreesboro--Franklin, TN    2792.403   .0024941 |
 25. |                                Gainesville, FL   2574.0385   .0023023 |
     |-----------------------------------------------------------------------|
 26. |                     Denver-Aurora-Lakewood, CO   2550.6364   .0022901 |
 27. |                                   Columbus, OH   2412.4815   .0021588 |
 28. |      Miami-Fort Lauderdale-West Palm Beach, FL        2295   .0020299 |
 29. |                           Cincinnati, OH-KY-IN   2161.2791   .0019335 |
 30. |                    Phoenix-Mesa-Scottsdale, AZ   2038.0833   .0018031 |
     +-----------------------------------------------------------------------+

    Result                      Number of obs
    -----------------------------------------
    Not matched                            54
        from master                        54  
        from using                          0  

    Matched                               184  
    -----------------------------------------
(72 missing values generated)
(238 missing values generated)
variable msa_lab was str1 now str22
(1 real change made)
(1 real change made)
(1 real change made)
variable msa_lab was str22 now str39
(1 real change made)
variable msa_lab was str39 now str44
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(0 real changes made)
(54 missing values generated)
(3 real changes made)
(4 real changes made)
(obs=184)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9323   1.0000


      Source |       SS           df       MS      Number of obs   =       184
-------------+----------------------------------   F(1, 182)       =   1208.48
       Model |   595114636         1   595114636   Prob > F        =    0.0000
    Residual |  89625584.8       182  492448.268   R-squared       =    0.8691
-------------+----------------------------------   Adj R-squared   =    0.8684
       Total |   684740221       183  3741749.84   Root MSE        =    701.75

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   18.40068   .5293145    34.76   0.000     17.35629    19.44506
       _cons |    124.078   55.49296     2.24   0.027     14.58577    233.5703
------------------------------------------------------------------------------
file ../output/figures/econ_v_ls_year_firstlast_cns.pdf saved as PDF format
(8 real changes made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(2 real changes made)
(5 real changes made)
file ../output/figures/pat_prod_scatter_year_firstlast_cns.pdf saved as PDF
    format
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_state_shp.dta created
  file usa_state.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           296,043  (_merge==3)
    -----------------------------------------
STATEFP: all characters numeric; replaced as byte
(9,030 observations deleted)
(344 observations deleted)
(116,302 real changes made)
(116,302 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
(166,263 real changes made)
(166,263 real changes made)
file usa_state_shp_clean.dta saved
  (importing .shp file)
  (importing .dbf file)
  (creating _ID spatial-unit id)
  (creating _CX coordinate)
  (creating _CY coordinate)

  file usa_msa_shp.dta created
  file usa_msa.dta     created

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           408,279  
    -----------------------------------------
CBSAFP: all characters numeric; replaced as long
(5,831 observations deleted)
(0 observations deleted)
(7,520 real changes made)
(7,520 real changes made)
(310 observations deleted)
(2,373 real changes made)
(2,373 real changes made)
file usa_msa_shp_clean.dta saved
(variable msatitle was str46, now str50 to accommodate using data's values)
(variable city was str35, now str42 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,084
        from master                     1,084  
        from using                          0  

    Matched                           101,942  
    -----------------------------------------
(12,339 real changes made)
(0 real changes made)
(2 real changes made)
file ../temp/map_samp.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                           705
        from master                       705  
        from using                          0  

    Matched                               240  
    -----------------------------------------
file ../output/figures/impact_cite_affl_wt_map_year_firstlast_cns.pdf saved
    as PDF format
(0 observations deleted)
(4 missing values generated)
(68,197 missing values generated)
file ../temp/econ_yr_cluster.dta saved

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,955  
    -----------------------------------------
(obs=3,955)

             | msa_size econ_m~e
-------------+------------------
    msa_size |   1.0000
econ_msa_s~e |   0.9191   1.0000


      Source |       SS           df       MS      Number of obs   =     3,955
-------------+----------------------------------   F(1, 3953)      =  21514.05
       Model |  4.3207e+10         1  4.3207e+10   Prob > F        =    0.0000
    Residual |  7.9390e+09     3,953   2008336.4   R-squared       =    0.8448
-------------+----------------------------------   Adj R-squared   =    0.8447
       Total |  5.1146e+10     3,954    12935357   Root MSE        =    1417.2

------------------------------------------------------------------------------
    msa_size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
econ_msa_s~e |   21.81318   .1487161   146.68   0.000     21.52161    22.10475
       _cons |   169.2905    26.1875     6.46   0.000     117.9482    220.6328
------------------------------------------------------------------------------
(3,955 missing values generated)
variable msa_lab was str1 now str27
(1 real change made)
(0 real changes made)
(1 real change made)
(0 real changes made)
variable msa_lab was str27 now str42
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         8,495
        from master                     8,495  
        from using                          0  

    Matched                            94,531  
    -----------------------------------------
(4 real changes made)
(7 real changes made)
(8,495 missing values generated)
(91,265 observations deleted)
(7,157 observations deleted)

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0167373       .0167373
 5%     .0251059       .0251059
10%     .1179977       .1179977       Obs                  26
25%     .3447181       .1179977       Sum of wgt.          26

50%     .6491676                      Mean           1.006028
                        Largest       Std. dev.      .8773801
75%     1.997337       2.186172
90%     2.186172       2.186172       Variance       .7697958
95%     2.346208       2.346208       Skewness       .5866851
99%     2.874625       2.874625       Kurtosis       1.959437

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |         26    2574.038     131.729       2310       2698

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0346486       .0152082
 5%     .1013877       .0346486
10%     .1754087       .0811101       Obs                 108
25%     .3841203       .0811101       Sum of wgt.         108

50%     .7680968                      Mean           1.459366
                        Largest       Std. dev.       2.11596
75%     1.613054        7.95857
90%      3.70112       10.35128       Variance       4.477288
95%     5.338365       11.26346       Skewness       3.256435
99%     11.26346       11.75166       Kurtosis       14.24424

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |        108    4284.546    218.9848       3740       4472

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0502118       .0027895
 5%     .2410166       .0100424
10%     .3345793       .0150635       Obs                 615
25%     .5049106       .0376588       Sum of wgt.         615

50%     .8987911                      Mean           1.640816
                        Largest       Std. dev.      2.873446
75%     1.663135       19.26873
90%     2.952064       19.26873       Variance       8.256694
95%     5.179971       34.37491       Skewness       6.735448
99%     13.14916       34.37491       Kurtosis       64.31931

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |        615    7699.207    514.5724       6580       8204

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0486661       .0050694
 5%     .1757413       .0062765
10%     .2699447       .0062765       Obs               1,726
25%     .5071391       .0101388       Sum of wgt.       1,726

50%     .9211794                      Mean           1.535026
                        Largest       Std. dev.      2.161575
75%      1.72603       23.11939
90%     3.313276       23.54802       Variance       4.672408
95%     4.651579        29.5214       Skewness       5.971955
99%     9.542235        29.5214       Kurtosis       57.88252

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      1,726    17429.25    492.5226      16364      17911

                  (sum) impact_cite_affl_wt
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0532285       .0027895
 5%     .2092158       .0067592
10%     .3138237       .0086904       Obs               2,129
25%     .5474934       .0114061       Sum of wgt.       2,129

50%     1.087922                      Mean           1.894572
                        Largest       Std. dev.      2.815695
75%     2.095683       25.38292
90%     3.986817        32.6702       Variance       7.928139
95%     6.184782        32.6702       Skewness       5.076561
99%     14.82491       33.58165       Kurtosis       39.58526

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    msa_size |      2,129    23396.08    1001.978      20879      24031
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    103,026
Absorbing 1 HDFE group                            F(   1, 103024) =   34965.99
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.2534
                                                  Adj R-squared   =     0.2534
                                                  Within R-sq.    =     0.2534
                                                  Root MSE        =     1.6653

------------------------------------------------------------------------------
        ln_y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .6429845   .0034386   186.99   0.000     .6362449     .649724
       _cons |  -7.001019   .0281435  -248.76   0.000     -7.05618   -6.945858
------------------------------------------------------------------------------
(dropped 28 singleton observations)
(MWFE estimator converged in 7 iterations)

HDFE Linear regression                            Number of obs   =    102,998
Absorbing 3 HDFE groups                           F(   1,    209) =       2.23
Statistics robust to heteroskedasticity           Prob > F        =     0.1367
                                                  R-squared       =     0.6461
                                                  Adj R-squared   =     0.6451
                                                  Within R-sq.    =     0.0003
Number of clusters (msa)     =        210         Root MSE        =     1.1480

                                  (Std. err. adjusted for 210 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0910618   .0609536     1.49   0.137    -.0291009    .2112245
       _cons |  -2.561142   .4904383    -5.22   0.000    -3.527982   -1.594302
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        78           0          78     |
         msa |       210         210           0    *|
       field |         5           1           4     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 36 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =    102,990
Absorbing 4 HDFE groups                           F(   1,    209) =       2.29
Statistics robust to heteroskedasticity           Prob > F        =     0.1320
                                                  R-squared       =     0.6499
                                                  Adj R-squared   =     0.6479
                                                  Within R-sq.    =     0.0003
Number of clusters (msa)     =        210         Root MSE        =     1.1436

                                  (Std. err. adjusted for 210 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0936766   .0619546     1.51   0.132    -.0284595    .2158126
       _cons |  -2.582018   .4985049    -5.18   0.000    -3.564761   -1.599276
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       210         210           0    *|
        field |         5           1           4     |
   field#year |       368          78         290    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 131 singleton observations)
(MWFE estimator converged in 10 iterations)

HDFE Linear regression                            Number of obs   =    102,895
Absorbing 5 HDFE groups                           F(   1,    201) =       1.58
Statistics robust to heteroskedasticity           Prob > F        =     0.2103
                                                  R-squared       =     0.6528
                                                  Adj R-squared   =     0.6487
                                                  Within R-sq.    =     0.0002
Number of clusters (msa)     =        202         Root MSE        =     1.1423

                                  (Std. err. adjusted for 202 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0794167   .0631926     1.26   0.210    -.0451887    .2040222
       _cons |  -2.467674   .5086926    -4.85   0.000    -3.470732   -1.464615
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       202         202           0    *|
        field |         5           1           4     |
   field#year |       368          78         290    ?|
    msa#field |       615         615           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 825 singleton observations)
(MWFE estimator converged in 15 iterations)

HDFE Linear regression                            Number of obs   =    102,201
Absorbing 6 HDFE groups                           F(   1,    190) =       0.55
Statistics robust to heteroskedasticity           Prob > F        =     0.4602
                                                  R-squared       =     0.6704
                                                  Adj R-squared   =     0.6624
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        191         Root MSE        =     1.1183

                                  (Std. err. adjusted for 191 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0372038   .0502708     0.74   0.460    -.0619568    .1363645
       _cons |  -2.124702   .4048967    -5.25   0.000    -2.923372   -1.326032
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        78           0          78     |
          msa |       191         191           0    *|
        field |         5           1           4     |
   field#year |       368          78         290    ?|
    msa#field |       601         601           0    *|
         inst |      1267        1267           0    *|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 44808 singleton observations)
(MWFE estimator converged in 53 iterations)

HDFE Linear regression                            Number of obs   =     58,218
Absorbing 7 HDFE groups                           F(   1,    150) =       0.11
Statistics robust to heteroskedasticity           Prob > F        =     0.7448
                                                  R-squared       =     0.7957
                                                  Adj R-squared   =     0.7050
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        151         Root MSE        =     1.0112

                                  (Std. err. adjusted for 151 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0279575   .0857465     0.33   0.745    -.1414695    .1973844
       _cons |  -1.930016   .6994397    -2.76   0.007    -3.312042   -.5479889
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        77           0          77     |
          msa |       151         151           0    *|
        field |         5           1           4     |
   field#year |       358          77         281    ?|
    msa#field |       483         483           0    *|
         inst |       784         784           0    *|
      athr_id |     16118           1       16117    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 41078 singleton observations)
(MWFE estimator converged in 45 iterations)

HDFE Linear regression                            Number of obs   =     53,453
Absorbing 7 HDFE groups                           F(   1,     94) =       1.18
Statistics robust to heteroskedasticity           Prob > F        =     0.2807
                                                  R-squared       =     0.7874
                                                  Adj R-squared   =     0.6954
                                                  Within R-sq.    =     0.0001
Number of clusters (msa)     =         95         Root MSE        =     1.0075

                                   (Std. err. adjusted for 95 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
   ln_x_econ |   .0473141   .0436074     1.09   0.281    -.0392695    .1338977
       _cons |  -1.869895   .2298746    -8.13   0.000    -2.326316   -1.413473
------------------------------------------------------------------------------

Absorbed degrees of freedom:
------------------------------------------------------+
  Absorbed FE | Categories  - Redundant  = Num. Coefs |
--------------+---------------------------------------|
         year |        77           0          77     |
          msa |        95          95           0    *|
        field |         5           1           4     |
   field#year |       353          77         276    ?|
    field#msa |       350         350           0    *|
         inst |       644         644           0    *|
      athr_id |     14707           1       14706    ?|
------------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 44706 singleton observations)
(MWFE estimator converged in 50 iterations)

HDFE Linear regression                            Number of obs   =     58,320
Absorbing 5 HDFE groups                           F(   1,    152) =       0.14
Statistics robust to heteroskedasticity           Prob > F        =     0.7081
                                                  R-squared       =     0.7910
                                                  Adj R-squared   =     0.7038
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        153         Root MSE        =     1.0132

                                  (Std. err. adjusted for 153 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0285484   .0760935     0.38   0.708    -.1217891     .178886
       _cons |  -1.935129   .6203622    -3.12   0.002    -3.160775   -.7094832
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        77           0          77     |
         msa |       153         153           0    *|
     athr_id |     16145           1       16144     |
       field |         5           1           4    ?|
        inst |       789         789           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 37391 singleton observations)
(MWFE estimator converged in 67 iterations)

HDFE Linear regression                            Number of obs   =     44,377
Absorbing 6 HDFE groups                           F(   1,    137) =       0.00
Statistics robust to heteroskedasticity           Prob > F        =     0.9771
                                                  R-squared       =     0.8243
                                                  Adj R-squared   =     0.6929
                                                  Within R-sq.    =     0.0000
Number of clusters (msa)     =        138         Root MSE        =     0.9605

                                  (Std. err. adjusted for 138 clusters in msa)
------------------------------------------------------------------------------
             |               Robust
        ln_y | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        ln_x |   .0030487   .1060635     0.03   0.977    -.2066845     .212782
       _cons |  -1.461526   .8824008    -1.66   0.100    -3.206413    .2833607
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |        77           0          77     |
         msa |       138         138           0    *|
     athr_id |     11976           1       11975     |
   gen_mesh1 |      2964          46        2918    ?|
   gen_mesh2 |      3397         112        3285    ?|
        inst |       595         595           0    *|
-----------------------------------------------------+
? = number of redundant parameters may be higher
* = FE nested within cluster; treated as redundant for DoF computation

. 
end of do-file

--------------------------------------------------------------------------------
Makelog ended: 2024-09-29 00:51:08
Working directory: /export/projects4/achandra_basicscience/analysis/science_geo/cluster_descriptives/code
--------------------------------------------------------------------------------
