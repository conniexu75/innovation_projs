--------------------------------------------------------------------------------
Makelog started: 2023-12-26 19:56:44
Working directory: /export/home/dor/cxu/innovation_projs/analysis/science_geo/cns_descriptives/code
--------------------------------------------------------------------------------
External links successfully created!

  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      17.0
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2021 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-STATA-PC        https://www.stata.com
                                   979-696-4600        stata@stata.com

Stata license: Unlimited-user 4-core network, expiring 17 Nov 2024
Serial number: 501809301897
  Licensed to: Harvard Business School
               Research Computing

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 120,000; see help set_maxvar.

. do "/export/home/dor/cxu/innovation_projs/analysis/science_geo/cns_descriptiv
> es/code/analysis.do" 

. set more off

. clear all

. capture log close

. program drop _all

. set scheme modern

. graph set window fontface "Arial Narrow"
not available in non-GUI version

. pause on

. set seed 8975

. here, set
/export/home/dor/cxu/innovation_projs/analysis/science_geo/cns_descriptives/cod
> e/

. 
. program main
  1.     global country_name "countries"
  2.     global us_state_name "US states"
  3.     global area_name "US cities"
  4.     global city_full_name "cities"
  5.     global inst_name "institutions"
  6.     global msatitle_name "MSAs"
  7.     global msa_comb_name "MSAs"
  8.     global msa_world_name "cities"
  9.     global msa_c_world_name "cities"
 10.     di "OUTPUT START"
 11.     foreach var in impact_affl_wt body_adj_wt {
 12.         /*di "CNS: `var'"
>         athr_loc, data(newfund) samp(cns) wt_var(`var')
>         qui trends, data(newfund) samp(cns) wt_var(`var')*/
.         di "ALL: `var'"
 13.         athr_loc, data(all) samp(jrnls) wt_var(`var')
 14.         qui trends, data(all) samp(jrnls) wt_var(`var')
 15.     }
 16.     *calc_broad_hhmi, data(`data') samp(`samp') 
.     top_mesh_terms, data(all) samp(jrnls) 
 17.     *qui output_tables, data(newfund) samp(cns) 
.     qui output_tables, data(all) samp(jrnls) 
 18. end

. 
. program athr_loc
  1.     syntax, data(str) samp(str)  wt_var(str)
  2.     local suf = ""
  3.     if "`wt_var'" == "cite_affl_wt" local suf "_wt"
  4.     if "`wt_var'" == "impact_affl_wt" local suf "_if"
  5.     if "`wt_var'" == "impact_cite_affl_wt" local suf "_if_wt"
  6.     if "`wt_var'" == "pat_adj_wt" local suf "_pat"
  7.     if "`wt_var'" == "frnt_adj_wt" local suf "_frnt"
  8.     if "`wt_var'" == "body_adj_wt" local suf "_body"
  9.     use ../external/openalex/cleaned_last5yrs_`data'_`samp', clear 
 10.     replace inst = "Mass General Brigham" if inlist(inst, "Massachusetts G
> eneral Hospital" , "Brigham and Women's Hospital")
 11.     local end 20
 12.     foreach loc in country msa_c_world inst {
 13.         if "`loc'" == "inst" & ("`wt_var'" != "pat_adj_wt" & "`wt_var'" !=
>  "body_adj_wt") {
 14.             local end 50
 15.         }
 16.         qui gunique pmid 
 17.         local articles = r(unique)
 18.         qui sum `wt_var'
 19.         local total = round(r(sum))
 20.         assert `total' == `articles'
 21.         qui sum `wt_var' if !mi(`loc') 
 22.         local denom = r(sum) 
 23.         preserve
 24.         if inlist("`loc'", "us_state", "area", "msatitle", "msa_comb") {
 25.             qui keep if country == "United States"
 26.         }
 27.         collapse (sum) `wt_var', by(`loc')
 28.         qui hashsort -`wt_var' 
 29.         qui gen perc = `wt_var' / `total' * 100
 30.         li if mi(`loc')
 31.         qui drop if mi(`loc')
 32.         qui gen cum_perc = sum(perc) 
 33.         gen rank = _n 
 34.         save ../temp/rankings_`loc'`suf', replace
 35.         drop rank
 36.         qui count
 37.         local rank_end = min(r(N),`end') 
 38.         li `loc' perc in 1/`rank_end'
 39.         di "Total articles: `total'"
 40.         mkmat perc cum_perc in 1/`rank_end', mat(top_`loc'_`samp'`suf')
 41. *        mat top_`loc'_`data'_`samp' = nullmat(top_`loc'_`data'_`samp') , 
> (top_`loc'_`samp'`suf')
.         qui levelsof `loc' in 1/2
 42.         global top2_`loc'_`data' "`r(levels)'"
 43.         if inlist("`loc'", "inst", "city_full", "msatitle","msa_comb", "ms
> aworld", "msa_c_world") {
 44.             qui levelsof `loc' in 1/`rank_end'
 45.             global `loc'_`data' "`r(levels)'"
 46.         }
 47.         qui gen rank_grp = "first" if _n == 1
 48.         replace `loc' = "harvard university" if `loc' == "university harva
> rd"
 49.         replace `loc' = "stanford university" if `loc' == "university stan
> ford"
 50.         qui levelsof `loc' if _n == 1 
 51.         global `loc'_first "`r(levels)'"
 52.         qui levelsof `loc' if _n == 2
 53. 
.         global `loc'_second "`r(levels)'"
 54.         qui replace rank_grp = "second" if _n == 2
 55.         qui replace rank_grp = "china" if `loc' == "China"
 56.         qui replace rank_grp = "uk" if `loc' == "United Kingdom"
 57.         qui replace rank_grp = "rest of top 10" if inrange(_n,3,10) & !inl
> ist(rank_grp,"china", "uk")
 58.         qui replace rank_grp = "remaining" if mi(rank_grp)
 59.         keep `loc' rank_grp
 60.         qui save ../temp/`loc'_rank_`data'_`samp'`suf', replace
 61.         restore
 62.     }
 63. end

. 
. program calc_broad_hhmi
  1.    syntax, data(str) samp(str) 
  2.    use if inrange(year, 1945, 2022) using ../external/openalex/cleaned_las
> t5yrs_`data'_`samp', clear
  3.    replace inst = "Mass General Brigham" if inlist(inst, "Massachusetts Ge
> neral Hospital" , "Brigham and Women's Hospital")
  4.    qui gunique pmid which_athr
  5.    local num_athrs = r(unique)
  6.    qui gunique pmid which_athr if country == "United States"
  7.    local num_athrs_US = r(unique)
  8.    foreach i in broad hhmi {
  9.        qui gunique pmid which_athr if has_`i'_affl == 1
 10.        local num_`i' = r(unique)
 11.        di `num_`i'' " authors of " `num_athrs' " are " "`i' affiliated or 
> " `num_`i''/`num_athrs'*100 " percent"
 12.        qui gunique pmid which_athr if has_`i'_affl == 1 & country == "Unit
> ed States"
 13.        local num_`i'_US = r(unique)
 14.        di `num_`i'_US' " US authors of " `num_athrs_US' " are " "`i' affil
> iated or " `num_`i'_US'/`num_athrs_US'*100 " percent"
 15.        // hhmi has to be us
.        preserve
 16.        keep if country == "United States"
 17.        qui gunique pmid which_athr if has_`i'_affl == 1 & inst == "Stanfor
> d University" 
 18.        local num_`i'_stanford = r(unique)
 19.        di `num_`i'_stanford' " stanford authors of " `num_`i'_US' " are " 
> "`i' affiliated or " `num_`i'_stanford'/`num_`i'_US'*100 " percent"
 20.        qui gunique pmid which_athr if has_`i'_affl == 1 & inst == "Harvard
>  University" 
 21.        local num_`i'_harvard = r(unique)
 22.        di `num_`i'_harvard' " harvard authors of " `num_`i'_US' " are " "`
> i' affiliated or " `num_`i'_harvard'/`num_`i'_US'*100 " percent"
 23.        restore
 24.        if "`i'" == "broad" {
 25.            qui count if  inlist(inst, "Harvard University", "Massachusetts
>  Institute of Technology", "Boston Children's Hospital", "Dana Farber Cancer 
> Institute", "Massachusetts General Hospital", "Brigham and Women's Hospital",
>  "Beth Israel Deaconess Medical Center")
 26.            if r(N) > 0 {
 27.                preserve
 28.                keep if inlist(inst, "Harvard University", "Massachusetts I
> nstitute of Technology", "Boston Children's Hospital", "Dana Farber Cancer In
> stitute", "Massachusetts General Hospital", "Brigham and Women's Hospital", "
> Beth Israel Deaconess Medical Center")
 29.                qui gunique pmid which_athr if has_`i'_affl == 1 
 30.                local num_athrs_broad = r(unique)
 31.                qui gunique pmid which_athr if has_`i'_affl == 1 & inst == 
> "Harvard University" 
 32.                local num_`i'_harvard = r(unique)
 33.                di `num_`i'_harvard' " harvard authors of " `num_athrs_broa
> d' " are " "`i' affiliated or " `num_`i'_harvard'/`num_athrs_broad'*100 " per
> cent"
 34.                qui gunique pmid which_athr if has_`i'_affl == 1 & inst == 
> "Massachusetts Institute of Technology" 
 35.                local num_`i'_mit= r(unique)
 36.                di `num_`i'_mit' " mit authors of " `num_athrs_broad' " are
>  " "`i' affiliated or " `num_`i'_mit'/`num_athrs_broad'*100 " percent"
 37.                restore 
 38.            }
 39.         }
 40.     }
 41. end

. 
. program trends
  1.     syntax, data(str) samp(str)  wt_var(str)
  2.     local suf = ""
  3.     if "`wt_var'" == "cite_affl_wt" local suf "_wt"
  4.     if "`wt_var'" == "impact_affl_wt" local suf "_if"
  5.     if "`wt_var'" == "impact_cite_affl_wt" local suf "_if_wt"
  6.     if "`wt_var'" == "pat_adj_wt" local suf "_pat"
  7.     if "`wt_var'" == "frnt_adj_wt" local suf "_frnt"
  8.     if "`wt_var'" == "body_adj_wt" local suf "_body"
  9.     use if inrange(year, 1945, 2022)  using ../external/openalex/cleaned_a
> ll_`data'_`samp', clear
 10.     replace inst = "Mass General Brigham" if inlist(inst, "Massachusetts G
> eneral Hospital" , "Brigham and Women's Hospital")
 11.     cap drop counter
 12. 
.     gen msa_world = msatitle
 13.     replace msa_world = city if country != "United States"
 14.     qui bys pmid year: gen counter = _n == 1
 15.     qui bys year: egen tot_in_yr = total(counter)
 16.     foreach loc in country  msa_c_world inst {
 17.         preserve
 18.         if inlist("`loc'", "us_state", "area", "msatitle", "msa_comb") {
 19.             qui keep if country == "United States"
 20.         }
 21.         replace `loc' = "harvard university" if `loc' == "university harva
> rd"
 22.         replace `loc' = "stanford university" if `loc' == "university stan
> ford"
 23.         qui merge m:1 `loc' using ../temp/`loc'_rank_`data'_`samp'`suf', a
> ssert(1 3) keep(1 3) nogen
 24.         if "`loc'" == "inst" {
 25.             replace `loc' = strproper(`loc')
 26.         }
 27.         qui sum year
 28.         local min_year = max(1945,r(min))
 29.         qui egen year_bin  = cut(year), at(1945(3)2023) 
 30.         keep if !mi(`loc')
 31.         local year_var year_bin
 32.         
.         /*qui bys pmid `year_var': replace counter = _n == 1
>         qui bys `year_var': egen tot_in_`year_var' = total(counter)
>         qui replace rank_grp = "remaining" if mi(rank_grp)
>         bys pmid: replace cite_count = . if _n !=1 
>         qui bys `year_var': egen tot_cites_in_`year_var' = total(cite_count)
>         replace cite_wt = cite_count/ tot_cites_in_`year_var' * tot_in_`year_
> var'
>         replace impact_wt = impact_wt * jrnl_N / tot_in_`year_var' 
>         hashsort pmid cite_wt
>         qui by pmid: replace cite_wt = cite_wt[_n-1] if mi(cite_wt)
>         replace cite_affl_wt = affl_wt * cite_wt 
>         replace impact_affl_wt = impact_wt * affl_wt*/
. 
.         collapse (sum) `wt_var'  (firstnm) `loc'  , by(rank_grp `year_var')
 33.         bys `year_var': egen tot_in_`year_var' = total(`wt_var')
 34.         qui gen perc = `wt_var'/tot_in_`year_var' * 100
 35.         qui bys `year_var': egen tot = sum(perc)
 36.         save ../temp/trends_`loc'`suf', replace
 37.         qui replace tot = round(tot)
 38.         assert tot==100
 39.         qui drop tot
 40.         if "`loc'" == "city_full" | "`loc'" == "msatitle" | "`loc'" == "ms
> a_world" |  "`loc'" == "msa_c_world" | "`loc'" == "msa_comb" {
 41.             label define rank_grp 1 ${`loc'_first} 2 ${`loc'_second} 3 "Re
> maining top 10" 4 "Remaining places" 
 42.         }
 43.         if "`loc'" == "inst" {
 44.             local proper_1 = strproper(${`loc'_first})
 45.             local proper_2 = strproper(${`loc'_second})
 46.             label define rank_grp 1 "`proper_1'" 2 "`proper_2'" 3 "Remaini
> ng top 10" 4 "Remaining places" 
 47.         }
 48.         if "`loc'" == "country" {
 49.             label define rank_grp 1 ${`loc'_first} 2 "United Kingdom" 3 "C
> hina" 4 "Remaining top 10" 5 "Remaining places" 
 50.         }
 51.         label var rank_grp rank_grp
 52.         qui gen group = 1 if rank_grp == "first"
 53.         qui replace group = 2 if rank_grp == "second"  & "`loc'"!= "countr
> y"
 54.         qui replace group = 2 if rank_grp == "uk" & "`loc'" == "country"
 55.         qui replace group = 3 if rank_grp == "china" & "`loc'" == "country
> "
 56.         local last = 2
 57.         if "`loc'" == "country" local last = 3 
 58.         qui replace group = `last'+1 if rank_grp == "rest of top 10" 
 59.         qui replace group = `last'+2 if rank_grp == "remaining"
 60.         *qui replace group = `last'+3 if rank_grp == "missing"
.         qui hashsort `year_var' -group
 61.         qui bys `year_var': gen stack_perc = sum(perc)
 62.         keep rank_grp `year_var' `loc' perc group stack_perc
 63.         local stacklines
 64.         qui xtset group `year_var' 
 65.         qui sum group 
 66.         local max_grp = r(max)
 67.         qui levelsof group, local(rank_grps)
 68.         local items = `r(r)'
 69.         foreach x of local rank_grps {
 70.            colorpalette carto Teal, intensify(0.85)  n(`items') nograph
 71.            local stacklines `stacklines' area stack_perc `year_var' if gro
> up == `x', fcolor("`r(p`x')'") lcolor(white) lwidth(*0.3) || 
 72. /*           if `x' == `max_grp' {
>                local stacklines `stacklines' area stack_perc `year_var' if gr
> oup == `x', fcolor("dimgray") lcolor(black) lwidth(*0.2) || 
>            }*/
.         }
 73.         qui gen labely = . 
 74.         qui gen rev_group = -group
 75.         if "`loc'"=="country" {
 76.             qui bys `year_var' (rev_group): replace labely = perc/2 if gro
> up == 5
 77.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] if group == 4
 78.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] + perc[_n-2] if group == 3
 79.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] + perc[_n-2] + perc[_n-3] if group == 2
 80.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] + perc[_n-2] + perc[_n-3] + perc[_n-4] if group == 1
 81.         }
 82.         if "`loc'"!="country" {
 83.             qui bys `year_var' (rev_group): replace labely = perc/2 if gro
> up == 4
 84.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] if group == 3
 85.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] + perc[_n-2] if group == 2
 86.             qui bys `year_var' (rev_group): replace labely = perc/2 + perc
> [_n-1] + perc[_n-2] + perc[_n-3] if group == 1
 87.         }
 88. *        qui gen labely_lab = "Missing Info" if group == `last'+3
.         qui gen labely_lab = "Everywhere else" if group == `last'+2
 89.         qui replace labely_lab = "Remaining top 10" if group == `last'+1
 90.         qui replace labely_lab = "China" if group == 3 & "`loc'"=="country
> "
 91.         qui replace labely_lab = ${`loc'_second} if group == 2
 92.         qui replace labely_lab = ${`loc'_second} if group == 2
 93.         qui replace labely_lab = ${`loc'_first} if group == 1
 94.         qui replace labely_lab = "United Kingdom" if group == 2 & "`loc'"=
> ="country"
 95.         qui replace labely_lab = strproper(${`loc'_second}) if group == 2 
> & "`loc'" == "inst"
 96.         qui replace labely_lab = strproper(${`loc'_first}) if group == 1 &
>  "`loc'" == "inst"
 97.         qui replace labely_lab = subinstr(labely_lab, "United States", "US
> ", .)
 98.         qui replace labely_lab = subinstr(labely_lab, "MA-NH", "US", .) if
>  strpos("`loc'" , "world")>0
 99.         qui replace labely_lab = subinstr(labely_lab, "NY-NJ-PA", "US", .)
>  if strpos("`loc'" , "world")>0
100.         qui replace labely_lab = subinstr(labely_lab, "CA", "US", .) if st
> rpos("`loc'" , "world")>0
101.         qui replace labely_lab = subinstr(labely_lab, "United Kingdom", "U
> K", .)
102.         qui sum `year_var'
103.         replace `year_var' = 2023 if `year_var' == r(max)
104.         if "`loc'" == "country" {
105.             graph tw `stacklines' (scatter labely `year_var' if `year_var'
>  ==2023, ms(smcircle) ///
>               msize(0.2) mcolor(black%40) mlabsize(vsmall) mlabcolor(black) m
> label(labely_lab)), ///
>               ytitle("Share of Worldwide Fundamental Science Research Output"
> , size(vsmall)) xtitle("Year", size(vsmall)) xlabel(`min_year'(2)2023, angle(
> 45) labsize(vsmall)) ylabel(0(10)100, labsize(vsmall)) ///
>               graphregion(margin(r+27)) plotregion(margin(zero)) ///
>               legend(off label(1 ${`loc'_first}) label(2 "United Kingdom") la
> bel(3 "China") label(4 "Remaining top 10") label(5 "Remaining places")  ring(
> 1) pos(6) rows(2))
106.             qui graph export ../output/figures/`loc'_stacked_`data'_`samp'
> `suf'.pdf , replace 
107.         }
108.         local w = 27 
109.         if ("`loc'" == "msatitle" | "`loc'" == "msa_world" | "`loc'" == "m
> sa_c_world" | "`loc'" == "msa_comb") local w = 27 
110.         if "`loc'" != "country" {
111.             graph tw `stacklines' (scatter labely `year_var' if `year_var'
>  ==2023, ms(smcircle) ///
>               msize(0.2) mcolor(black%40) mlabsize(vsmall) mlabcolor(black) m
> label(labely_lab)), ///
>               ytitle("Share of Worldwide Fundamental Science Research Output"
> , size(vsmall)) xtitle("Year", size(vsmall)) xlabel(`min_year'(2)2023, angle(
> 45) labsize(vsmall)) ylabel(0(10)100, labsize(vsmall)) ///
>               graphregion(margin(r+`w')) plotregion(margin(zero)) ///
>               legend(off label(1 ${`loc'_first}) label(2 ${`loc'_second}) lab
> el(3 "Remaining top 10") label(4 "Remaining places")  ring(1) pos(6) rows(2))
112.             qui graph export ../output/figures/`loc'_stacked_`data'_`samp'
> `suf'.pdf , replace 
113.         }
114.         restore
115.     }
116. end 

.     
. program top_mesh_terms
  1.     syntax, data(str) samp(str) 
  2.     foreach mesh in gen_mesh {
  3.         use ../external/mesh/contracted_`mesh'_`data'_`samp', clear
  4.         gunique pmid
  5.         local total_articles = r(unique)
  6.         qui bys pmid: gen wt = 1/_N
  7.         qui bys pmid: gen num_`mesh' = _N
  8.         sum num_`mesh'
  9.         cap drop _freq
 10.         collapse (sum) article_wt = wt , by(`mesh')
 11.         qui hashsort -article_wt
 12.         qui gen perc = article_wt/`total_articles'*100
 13.         qui gen cum_perc = sum(perc) 
 14.         qui sum article_wt
 15.         local total = round(r(sum))
 16.         qui count
 17.         local rank_end = min(20,r(N))
 18.         li in 1/`rank_end'
 19.         mkmat article_wt perc cum_perc in 1/`rank_end', mat(top_`mesh'_`sa
> mp')
 20.         mat top_`mesh'_`data'_`samp' = top_`mesh'_`samp' \ (.,`total', .)
 21.         qui levelsof `mesh' in 1/3, local(`mesh'_terms_`data')
 22.         qui gen rank = _n
 23.         qui replace rank = 4 if rank > 3
 24.         qui replace `mesh' = "other" if rank == 4
 25.         qui gen inst = "total"
 26.         collapse (sum) article_wt perc cum_perc, by(inst `mesh' rank)
 27.         drop rank
 28.         qui save ../temp/`mesh'_`data'_`samp', replace
 29.     }
 30. end

. 
. program output_tables
  1.     syntax, data(str) samp(str)
  2.     cap mat if_comb = top_country_jrnls_if \ top_msa_c_world_jrnls_if
  3.     cap matrix_to_txt, saving("../output/tables/if_comb.txt") matrix(if_co
> mb) title(<tab:if_comb>) format(%20.4f) replace
  4.     cap mat body_comb = top_country_jrnls_body \ top_msa_c_world_jrnls_bod
> y \ top_inst_jrnls_body
  5.     cap matrix_to_txt, saving("../output/tables/body_comb.txt") matrix(bod
> y_comb) title(<tab:body_comb>) format(%20.4f) replace
  6.     foreach file in top_country top_msa_c_world top_inst {
  7.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_wt.t
> xt") matrix(`file'_`samp'_wt) ///
>            title(<tab:`file'_`samp'_wt>) format(%20.4f) replace
  8.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'.txt"
> ) matrix(`file'_`samp') ///
>            title(<tab:`file'_`samp'>) format(%20.4f) replace
  9.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_if.t
> xt") matrix(`file'_`samp'_if) ///
>            title(<tab:`file'_`samp'_if>) format(%20.4f) replace
 10.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_if_w
> t.txt") matrix(`file'_`samp'_if_wt) ///
>            title(<tab:`file'_`samp'_if_wt>) format(%20.4f) replace
 11.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_pat.
> txt") matrix(`file'_`samp'_pat) ///
>            title(<tab:`file'_`samp'_pat>) format(%20.4f) replace
 12.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_frnt
> .txt") matrix(`file'_`samp'_frnt) ///
>            title(<tab:`file'_`samp'_frnt>) format(%20.4f) replace
 13.         cap qui matrix_to_txt, saving("../output/tables/`file'_`samp'_body
> .txt") matrix(`file'_`samp'_body) ///
>            title(<tab:`file'_`samp'_body>) format(%20.4f) replace
 14.          }
 15.  end

. ** 
. main
OUTPUT START
ALL: impact_affl_wt
(107 real changes made)
(file ../temp/rankings_country_if.dta not found)
file ../temp/rankings_country_if.dta saved

     +---------------------------+
     |        country       perc |
     |---------------------------|
  1. |  United States   52.16246 |
  2. |          China   9.338179 |
  3. | United Kingdom   8.025126 |
  4. |        Germany   5.668947 |
  5. |         Canada   2.542314 |
     |---------------------------|
  6. |          Japan   2.485297 |
  7. |    Switzerland   2.413446 |
  8. |         France   2.317665 |
  9. |    Netherlands   1.839935 |
 10. |      Australia   1.611957 |
     |---------------------------|
 11. |         Israel   1.280963 |
 12. |         Sweden   1.216993 |
 13. |          Spain   1.109855 |
 14. |    South Korea   1.045529 |
 15. |          Italy    1.00291 |
     |---------------------------|
 16. |        Austria    .743035 |
 17. |        Belgium   .6598715 |
 18. |        Denmark    .593981 |
 19. |      Singapore   .5481879 |
 20. |          India   .3013424 |
     +---------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)

      +--------------------------------+
      | msa_c_~d   impact~t       perc |
      |--------------------------------|
  59. |            411.4429   .2906491 |
      +--------------------------------+
(file ../temp/rankings_msa_c_world_if.dta not found)
file ../temp/rankings_msa_c_world_if.dta saved

     +-------------------------------------------------+
     |                          msa_c_world       perc |
     |-------------------------------------------------|
  1. |          Boston-Cambridge-Newton, US   9.779922 |
  2. |                         Bay Area, US   7.342592 |
  3. |      New York-Newark-Jersey City, US    6.30067 |
  4. |                          Beijing, CN   4.749757 |
  5. |  Washington-Arlington-Alexandria, US   2.363936 |
     |-------------------------------------------------|
  6. |                        Cambridge, GB   2.305367 |
  7. |               San Diego-Carlsbad, US   2.287994 |
  8. |                           London, GB   2.254483 |
  9. |   Los Angeles-Long Beach-Anaheim, US   2.119907 |
 10. |          Seattle-Tacoma-Bellevue, US   1.543239 |
     |-------------------------------------------------|
 11. | Houston-The Woodlands-Sugar Land, US   1.483217 |
 12. |   Philadelphia-Camden-Wilmington, US    1.45085 |
 13. |                New Haven-Milford, US   1.359939 |
 14. |           Research Triangle Park, US   1.315857 |
 15. |                            Paris, FR   1.277142 |
     |-------------------------------------------------|
 16. |                           Oxford, GB   1.114447 |
 17. |                          Toronto, CA   1.071306 |
 18. |        Baltimore-Columbia-Towson, US   1.037501 |
 19. |         Chicago-Naperville-Elgin, US   1.030394 |
 20. |                           Ithaca, US   .9532866 |
     +-------------------------------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)

       +----------------------------+
       | inst   impact~t       perc |
       |----------------------------|
    1. |        9176.843   6.482652 |
       +----------------------------+
(file ../temp/rankings_inst_if.dta not found)
file ../temp/rankings_inst_if.dta saved

     +----------------------------------------------------------------+
     |                                                inst       perc |
     |----------------------------------------------------------------|
  1. |                                  Harvard University   3.687127 |
  2. |                                 Stanford University   3.032335 |
  3. |             University of California, San Francisco   1.766154 |
  4. |               Massachusetts Institute of Technology   1.715312 |
  5. |                         Chinese Academy of Sciences   1.595938 |
     |----------------------------------------------------------------|
  6. |                       National Institutes of Health   1.532877 |
  7. |                                  Max Planck Society   1.458607 |
  8. |                                     Yale University   1.176987 |
  9. |                 University of California, San Diego   1.138439 |
 10. |                                Mass General Brigham   1.089887 |
     |----------------------------------------------------------------|
 11. |                                 Columbia University   .9848566 |
 12. |                          University of Pennsylvania   .9753354 |
 13. |                              Rockefeller University   .9407855 |
 14. |                                   Boston University    .937872 |
 15. |                                  Cornell University   .9202494 |
     |----------------------------------------------------------------|
 16. |              Memorial Sloan Kettering Cancer Center   .9019318 |
 17. |                  University of California, Berkeley   .8802395 |
 18. |                            Johns Hopkins University   .8660749 |
 19. |                             University of Cambridge   .8619183 |
 20. |                                University of Oxford   .7571538 |
     |----------------------------------------------------------------|
 21. |                            University of Washington   .7539535 |
 22. |                  Washington University in St. Louis   .7509714 |
 23. |                                   Peking University   .7198046 |
 24. |                                 New York University   .6876833 |
 25. |                       Weizmann Institute of Science   .6784875 |
     |----------------------------------------------------------------|
 26. |               University of California, Los Angeles   .6587516 |
 27. |             Icahn School of Medicine at Mount Sinai   .6394244 |
 28. |                            Medical Research Council   .6157824 |
 29. |                                Princeton University   .5582177 |
 30. |                        Dana-Farber Cancer Institute   .5504862 |
     |----------------------------------------------------------------|
 31. |                                     Duke University   .5204092 |
 32. |                           University College London   .5081586 |
 33. |   The University of Texas MD Anderson Cancer Center   .4946045 |
 34. |    Helmholtz Association of German Research Centres   .4858078 |
 35. | The University of Texas Southwestern Medical Center   .4842179 |
     |----------------------------------------------------------------|
 36. |                  California Institute of Technology   .4782873 |
 37. |                               University of Chicago   .4753241 |
 38. |                          Baylor College of Medicine   .4700392 |
 39. |                                Karolinska Institute   .4526078 |
 40. |         University of North Carolina at Chapel Hill   .4507605 |
     |----------------------------------------------------------------|
 41. |                    University of Michigan–Ann Arbor   .4427162 |
 42. |                           Wellcome Sanger Institute    .418442 |
 43. |                          Boston Children's Hospital   .4143488 |
 44. |                             Northwestern University   .4016656 |
 45. |                               University of Toronto   .3985347 |
     |----------------------------------------------------------------|
 46. |                             Imperial College London   .3981997 |
 47. |                          Scripps Research Institute   .3884482 |
 48. |      French National Centre for Scientific Research    .386609 |
 49. |               Salk Institute for Biological Studies   .3760632 |
 50. |                                              Inserm   .3747947 |
     +----------------------------------------------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)
ALL: body_adj_wt
(107 real changes made)
(file ../temp/rankings_country_body.dta not found)
file ../temp/rankings_country_body.dta saved

     +---------------------------+
     |        country       perc |
     |---------------------------|
  1. |  United States   59.89545 |
  2. |          China   10.77966 |
  3. | United Kingdom    5.01938 |
  4. |        Germany   4.838151 |
  5. |          Japan   3.604207 |
     |---------------------------|
  6. |    Switzerland   2.140143 |
  7. |         Canada   1.626616 |
  8. |    Netherlands   1.415018 |
  9. |         Sweden   1.297527 |
 10. |    South Korea   1.222303 |
     |---------------------------|
 11. |         France   1.013499 |
 12. |      Australia   .9390514 |
 13. |         Israel   .7547695 |
 14. |          Italy   .6503155 |
 15. |        Denmark   .5229426 |
     |---------------------------|
 16. |          Spain   .4757081 |
 17. |      Singapore   .4714141 |
 18. |         Taiwan   .3811356 |
 19. |        Austria   .3647354 |
 20. |   South Africa    .353871 |
     +---------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)

      +--------------------------------+
      | msa_c_~d   body_a~t       perc |
      |--------------------------------|
 104. |            161.8533   .1143355 |
      +--------------------------------+
(file ../temp/rankings_msa_c_world_body.dta not found)
file ../temp/rankings_msa_c_world_body.dta saved

     +-------------------------------------------------+
     |                          msa_c_world       perc |
     |-------------------------------------------------|
  1. |          Boston-Cambridge-Newton, US    16.9364 |
  2. |                         Bay Area, US   9.184037 |
  3. |                          Beijing, CN   7.537503 |
  4. |      New York-Newark-Jersey City, US   7.419494 |
  5. |               San Diego-Carlsbad, US   2.839038 |
     |-------------------------------------------------|
  6. |   Los Angeles-Long Beach-Anaheim, US   2.327529 |
  7. |  Washington-Arlington-Alexandria, US   2.210193 |
  8. |                           London, GB   1.884259 |
  9. | Houston-The Woodlands-Sugar Land, US    1.74835 |
 10. |          Seattle-Tacoma-Bellevue, US   1.458942 |
     |-------------------------------------------------|
 11. |   Philadelphia-Camden-Wilmington, US   1.414966 |
 12. |                        Cambridge, GB   1.229443 |
 13. |           Research Triangle Park, US   1.161928 |
 14. |      Dallas-Fort Worth-Arlington, US   1.066114 |
 15. |        Baltimore-Columbia-Towson, US   .9895453 |
     |-------------------------------------------------|
 16. |                        Göttingen, DE   .9327914 |
 17. |                        Stockholm, SE   .9130285 |
 18. |                          Toronto, CA   .8707605 |
 19. |                           Berlin, DE   .8642418 |
 20. |                            Tokyo, JP   .8602065 |
     +-------------------------------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)

       +----------------------------+
       | inst   body_a~t       perc |
       |----------------------------|
    2. |        8215.997   5.803897 |
       +----------------------------+
(file ../temp/rankings_inst_body.dta not found)
file ../temp/rankings_inst_body.dta saved

     +----------------------------------------------------------------+
     |                                                inst       perc |
     |----------------------------------------------------------------|
  1. |                                  Harvard University   6.237493 |
  2. |               Massachusetts Institute of Technology    4.37398 |
  3. |                                 Stanford University   2.884359 |
  4. |                  University of California, Berkeley   2.461576 |
  5. |                                     Broad Institute   2.454747 |
     |----------------------------------------------------------------|
  6. |                         Chinese Academy of Sciences   1.986333 |
  7. |                                Mass General Brigham   1.975469 |
  8. |                       National Institutes of Health    1.81752 |
  9. |             University of California, San Francisco   1.635825 |
 10. |                  California Institute of Technology   1.354229 |
     |----------------------------------------------------------------|
 11. |                                   Boston University   1.297268 |
 12. |              Memorial Sloan Kettering Cancer Center   1.115263 |
 13. | The University of Texas Southwestern Medical Center   1.029382 |
 14. |                            Johns Hopkins University   .9889762 |
 15. |                          University of Pennsylvania     .98313 |
     |----------------------------------------------------------------|
 16. |                            University of Washington   .9487259 |
 17. |                                  Cornell University   .9367233 |
 18. |                        Dana-Farber Cancer Institute   .8649144 |
 19. |                                     Yale University   .7816719 |
 20. |                                 Columbia University   .7252285 |
     +----------------------------------------------------------------+
Total articles: 141560
(0 real changes made)
(0 real changes made)
N = 1,120,251; 324,925 unbalanced groups of sizes 1 to 18

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
num_gen_mesh |  1,120,251    4.316905    1.764043          1         18

     +-----------------------------------------------------------+
     |                 gen_mesh   articl~t       perc   cum_perc |
     |-----------------------------------------------------------|
  1. |                Receptors   4335.183    1.33421    1.33421 |
  2. |                      DNA   2893.005    .890361   2.224571 |
  3. |                      RNA   2797.486   .8609636   3.085535 |
  4. |                  Neurons   2278.567   .7012594   3.786794 |
  5. |                    Brain   2172.548   .6686307   4.455425 |
     |-----------------------------------------------------------|
  6. |                Neoplasms   1887.862   .5810147   5.036439 |
  7. |                 Proteins    1866.58   .5744649   5.610905 |
  8. |    Transcription Factors   1749.101   .5383091   6.149214 |
  9. |     DNA-Binding Proteins   1411.677   .4344624   6.583676 |
 10. |         Breast Neoplasms   1408.975   .4336307   7.017307 |
     |-----------------------------------------------------------|
 11. |       Bacterial Proteins   1376.878   .4237524   7.441059 |
 12. |           HIV Infections   1361.522   .4190266   7.860085 |
 13. |                Carcinoma   1320.636   .4064434   8.266529 |
 14. |         Escherichia coli   1313.117   .4041293   8.670658 |
 15. | Saccharomyces cerevisiae   1304.971   .4016221   9.072281 |
     |-----------------------------------------------------------|
 16. |        Membrane Proteins   1282.378   .3946689   9.466949 |
 17. |                MicroRNAs   1230.796   .3787938   9.845743 |
 18. |            T-Lymphocytes   1214.863   .3738903   10.21963 |
 19. |                    Liver   1084.779   .3338552   10.55349 |
 20. |        Diabetes Mellitus   1014.214   .3121379   10.86563 |
     +-----------------------------------------------------------+

. 
end of do-file

--------------------------------------------------------------------------------
Makelog ended: 2023-12-26 19:58:09
Working directory: /export/home/dor/cxu/innovation_projs/analysis/science_geo/cns_descriptives/code
--------------------------------------------------------------------------------
